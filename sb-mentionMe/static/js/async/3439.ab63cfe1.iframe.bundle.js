"use strict";(globalThis.webpackChunk_mention_me_frontend=globalThis.webpackChunk_mention_me_frontend||[]).push([["3439"],{"./src/consumer/journey/NPS/NPSPage.tsx":function(e,t,n){n.d(t,{Z:()=>v});var r=n("../node_modules/react/jsx-runtime.js"),o=n("../node_modules/react/index.js"),s=n("./src/consumer/journey/hooks/JourneyContext.tsx"),a=n("./src/consumer/journey/hooks/useJourneyData.tsx"),i=n("../node_modules/classnames/index.js"),c=n.n(i),d=n("./src/shared/constants/preview.ts"),u=n("./src/shared/utilities/isSpaceKeyboardEvent.ts"),l=n("./src/consumer/journey/components/ContentItem.tsx"),m=n("./src/consumer/journey/components/Header.tsx"),p=n("./src/consumer/journey/components/InformationNotice.tsx"),E=n("./src/consumer/journey/components/PageTransition.tsx"),_=n("./src/consumer/journey/hooks/useContentItem.tsx"),T=n("./src/consumer/journey/types.ts");let N=e=>{var t;let{situation:n,showOrderComplete:s,includePrivacyNotices:a,handleContinue:i,handleScoreClick:N,previewMode:f,isScoreNonMandatory:h,shouldShowFeedbackAfterScore:S}=e,[C,O]=(0,o.useState)(""),[y,I]=(0,o.useState)(-1),[R,v]=(0,o.useState)(-1),g=(0,o.useRef)(),[x,k]=(0,o.useState)(S),j=(0,_.Z)(T.qo.FEEDBACK_PLACEHOLDER);(0,o.useEffect)(()=>()=>{void 0!==g.current&&clearTimeout(g.current)},[]);let b=e=>{v(e),I(e),k(!1),N(e)},M=e=>{void 0!==g.current&&clearTimeout(g.current),v(e)},A=()=>{g.current=setTimeout(()=>v(y),100)},q=f===d.i4.EDIT;return(0,r.jsxs)(E.Z,{className:`referrer referrer-offer referrer-offer--${n} mm-frame-nps mm-frame-nps-survey`,dataStage:"referrer-offer",children:[s&&(0,r.jsx)(l.Z,{tag:T.qo.ORDER_COMPLETE}),(0,r.jsx)(m.Z,{id:"nps-title",tag:T.qo.HEADLINE,shouldAutoFocus:!0}),(0,r.jsxs)("form",{onSubmit:q?void 0:e=>(e.preventDefault(),i(y,C),!1),method:"POST",children:[(0,r.jsxs)("div",{className:"mm-nps-question-score",children:[(0,r.jsxs)("div",{className:"mm-nps-labels",children:[(0,r.jsx)("span",{className:"mm-nps-question-score-likelihood-left",children:(0,r.jsx)(l.Z,{tag:T.qo.ANSWER_SCALE_LOW,hasNoWrapper:!0})}),(0,r.jsx)("span",{className:"mm-nps-question-score-likelihood-right",children:(0,r.jsx)(l.Z,{tag:T.qo.ANSWER_SCALE_HIGH,hasNoWrapper:!0})})]}),(0,r.jsx)("div",{className:"mm-nps-buttons","data-auto-class":"nps-buttons",role:"radiogroup","aria-labelledby":"nps-title",children:[0,1,2,3,4,5,6,7,8,9,10].map(e=>(0,r.jsxs)("label",{className:c()("mm-nps-score",e<=R?"mm-nps-score-active":""),tabIndex:-1,onMouseOver:()=>M(e),onMouseOut:()=>A(),children:[(0,r.jsx)("input",{type:"radio",value:e,name:"score",className:"visuallyhidden",onKeyPress:t=>{(0,u.Z)(t)&&b(e)},onChange:t=>{t.target.checked&&b(e)},required:!h}),e,0===e&&(0,r.jsxs)("span",{className:"visuallyhidden",children:[" - ",(0,r.jsx)(l.Z,{tag:T.qo.ANSWER_SCALE_LOW,hasNoWrapper:!0})]}),10===e&&(0,r.jsxs)("span",{className:"visuallyhidden",children:[" - ",(0,r.jsx)(l.Z,{tag:T.qo.ANSWER_SCALE_HIGH,hasNoWrapper:!0})]})]},e))})]}),!x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{id:"nps-feedback-title",children:(0,r.jsx)(l.Z,{tag:T.qo.FEEDBACK_REQUEST,hasNoWrapper:!0})}),(0,r.jsx)("textarea",{name:"feedback",placeholder:(null===(t=j.contentItem)||void 0===t?void 0:t.content)??"",value:C,onChange:e=>O(e.target.value),"aria-labelledby":"nps-feedback-title"}),(0,r.jsx)("div",{className:"mm-nps-feedback-disclaimer",children:(0,r.jsx)(l.Z,{tag:T.qo.FEEDBACK_DISCLAIMER,hasNoWrapper:!0})}),(0,r.jsx)("div",{className:"mm-button mm-submit",children:(0,r.jsx)("button",{type:"submit",children:(0,r.jsx)(l.Z,{tag:T.qo.SUBMIT_BUTTON,hasNoWrapper:!0})})})]})]}),a&&(0,r.jsx)(p.Z,{tag:T.qo.INFORMATION_NOTICE})]})};N.__docgenInfo={description:"",methods:[],displayName:"NPS",props:{situation:{required:!0,tsType:{name:"string"},description:""},showOrderComplete:{required:!0,tsType:{name:"boolean"},description:""},includePrivacyNotices:{required:!0,tsType:{name:"boolean"},description:""},handleContinue:{required:!0,tsType:{name:"signature",type:"function",raw:"(score: number, feedback: string) => void",signature:{arguments:[{type:{name:"number"},name:"score"},{type:{name:"string"},name:"feedback"}],return:{name:"void"}}},description:""},handleScoreClick:{required:!0,tsType:{name:"signature",type:"function",raw:"(score: number) => void",signature:{arguments:[{type:{name:"number"},name:"score"}],return:{name:"void"}}},description:""},previewMode:{required:!1,tsType:{name:"PREVIEW_MODE"},description:""},isScoreNonMandatory:{required:!1,tsType:{name:"boolean"},description:""},shouldShowFeedbackAfterScore:{required:!1,tsType:{name:"boolean"},description:""}}};let f=e=>{let{situation:t}=e;return(0,r.jsx)(E.Z,{className:`referrer referrer-offer referrer-offer--${t} mm-frame-nps mm-frame-nps-thanks`,dataStage:"referrer-offer",children:(0,r.jsx)(m.Z,{tag:T.qo.THANKS})})};f.__docgenInfo={description:"",methods:[],displayName:"NPSThanksPage",props:{situation:{required:!0,tsType:{name:"string"},description:""}}};var h=n("../node_modules/axios/lib/axios.js"),S=n("./src/shared/utilities/index.ts");let C=e=>{let{flowId:t,partnerCode:n,quickLinkCode:r,situation:s,segment:a,email:i,firstname:c,surname:d,username:u,customerId:l}=e;return(0,o.useCallback)((e,o)=>h.Z.post((0,S.nu)("record_nps_seamless_survey_response",{flowId:t,quickLinkCode:r,situation:s}),{partnerCode:n,segment:a,email:i,firstname:c,surname:d,username:u,customer_id:l,score:e,feedback:o}),[t,r,s,i,c,d,u,l,n,a])};var O=n("./src/shared/utilities/createFormClickHandler.ts");let y=e=>{let{flowId:t,partnerCode:n,quickLinkCode:r,situation:s,segment:a,email:i,firstname:c,surname:d,username:u,customerId:l}=e;return(0,o.useCallback)((e,o)=>{(0,O.Z)((0,S.nu)("record_nps_seamless_survey_response_and_resegment",{flowId:t,quickLinkCode:r,situation:s}),{partnerCode:n,segment:a,email:i,firstname:c,surname:d,username:u,customer_id:l,score:e<0||e>10?null:e,feedback:o,...Object.fromEntries(new URLSearchParams(window.location.search).entries())})()},[t,r,s,i,c,d,u,l,n,a])},I=(e,t)=>t.npsConfig.minScoreForResegmentation<=e,R=e=>{let{situation:t,merchant:n,offer:i,previewMode:c,flowId:d,segment:u,showOrderComplete:l,includePrivacyNotices:m}=e,{step:p,user:{email:E,firstname:_,surname:T,username:h,customerId:S}}=(0,s.Lz)(),O=(0,o.useRef)(),R=(0,o.useRef)(Promise.resolve());(0,o.useEffect)(()=>()=>{void 0!==O.current&&clearTimeout(O.current)},[]);let{isDesignPreview:v,isInPreview:g,offer:{npsConfig:x}}=(0,a.Z)(),{setStep:k}=(0,s.Nk)(),j=!!(null==x?void 0:x.isScoreNonMandatory),b=!!(null==x?void 0:x.shouldShowFeedbackAfterScore),M=C({flowId:d,partnerCode:n.partnerCode,quickLinkCode:i.quickLinkCode,situation:t,email:E,firstname:_,surname:T,username:h,customerId:S,segment:u}),A=y({flowId:d,partnerCode:n.partnerCode,quickLinkCode:i.quickLinkCode,situation:t,email:E,firstname:_,surname:T,username:h,customerId:S,segment:u}),q=(0,o.useCallback)(e=>{if(!g&&!v)void 0!==O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{R.current=M(e)},200)},[M,v,g]),w=(0,o.useCallback)((e,t)=>{if(!g||!!v)void 0!==O.current&&clearTimeout(O.current),R.current.finally(()=>{I(e,i)||j&&-1===e?g||v?k(2):A(e,t):(!g&&!v&&M(e,t),k(1))})},[v,g,M,A,i,j,k]);switch(p){case 1:case 2:return(0,r.jsx)(f,{situation:t});default:return(0,r.jsx)(N,{situation:t,showOrderComplete:l??!0,includePrivacyNotices:m??!0,handleContinue:w,handleScoreClick:q,isScoreNonMandatory:j,previewMode:c,shouldShowFeedbackAfterScore:b})}},v=R;R.__docgenInfo={description:"",methods:[],displayName:"NPSPage",props:{offer:{required:!0,tsType:{name:"Pick",elements:[{name:'intersection["offer"]',raw:'JourneyData["offer"]'},{name:"union",raw:'"id" | "quickLinkCode" | "type" | "npsConfig"',elements:[{name:"literal",value:'"id"'},{name:"literal",value:'"quickLinkCode"'},{name:"literal",value:'"type"'},{name:"literal",value:'"npsConfig"'}]}],raw:'Pick<JourneyData["offer"], "id" | "quickLinkCode" | "type" | "npsConfig">'},description:""},merchant:{required:!0,tsType:{name:"Pick",elements:[{name:'intersection["merchant"]',raw:'JourneyData["merchant"]'},{name:"literal",value:'"partnerCode"'}],raw:'Pick<JourneyData["merchant"], "partnerCode">'},description:""}}}},"./src/consumer/journey/NPS/__mocks__/mockData.ts":function(e,t,n){n.d(t,{LT:function(){return i}});var r=n("./src/shared/constants/filterOfferTypes.ts"),o=n("./src/consumer/journey/hooks/JourneyContext.tsx"),s=n("./src/consumer/journey/types.ts");let a={offer:{contentItems:{[s.qo.HEADLINE]:{id:"1",content:"How likely are you to recommend Brand to a friend?"},[s.qo.ORDER_COMPLETE]:{id:"2",content:"Your order is complete. Thank you, Name."},[s.qo.ORDER_COMPLETE_ANONYMOUS]:{id:"3",content:"Your order is complete. Thank you."},[s.qo.INFORMATION_NOTICE]:{id:"4",content:'This feedback service is managed by Mention Me who will process your data. <br/><a data-left="600" data-top="300" data-height="470" data-width="790" href="https://mentionme.dev/help/privacy_policy#referrers" class="mm-popup-link-opener" data-value="" data-label="Privacy Policy Link" data-action="Click Information Notice" data-category="All Pages" data-trackable="" data-event-click="true"> More info and your privacy rights</a>.'},[s.qo.ANSWER_SCALE_LOW]:{id:"5",content:"Not likely"},[s.qo.ANSWER_SCALE_HIGH]:{id:"6",content:"Very likely"},[s.qo.FEEDBACK_REQUEST]:{id:"9",content:"How could we improve?"},[s.qo.FEEDBACK_PLACEHOLDER]:{id:"12",content:"Please share your experience"},[s.qo.FEEDBACK_DISCLAIMER]:{id:"13",content:"Please don't share any personal information, contact details, or passwords."},[s.qo.SUBMIT_BUTTON]:{id:"14",content:"Continue"},[s.qo.THANKS]:{id:"15",content:"Thanks, we really appreciate your feedback."},[s.I.TERMS_AND_CONDITIONS]:{id:"16",content:'By accepting this offer you agree to the <a class="mm-popup-link-opener link link-small" href="https://mentionme.dev/me/terms/132084/cvvisxuo" data-left="600" data-top="300" data-height="470" data-width="790" data-event-click="true">Terms and Conditions</a>'}},quickLinkCode:"quickCode",id:"123",type:r.Z.NPS_ONLY,npsConfig:{minScoreForResegmentation:8}},layout:"modal",situation:"postpurchase",segment:"segment",showOrderComplete:!0,includePrivacyNotices:!0,includeMentionMeLogoInFlow:!0,isInPreview:!1,isDesignPreview:!1,merchant:{partnerCode:"partnerCode"},flowId:"flowId",user:{email:"a@a.com",firstname:"test",surname:"test",customerId:"customerId",username:"username",isSaved:!0}},i=e=>(window.MentionMe={JourneyData:a},(0,o.o2)(e))},"./src/consumer/journey/components/Header.tsx":function(e,t,n){n.d(t,{Z:function(){return i}});var r=n("../node_modules/react/jsx-runtime.js"),o=n("./src/shared/hooks/useFocusTrap/index.ts"),s=n("./src/consumer/journey/components/ContentItem.tsx");let a=e=>{let{tag:t,shouldAutoFocus:n=!1,previewMode:a,id:i}=e,c=n?{...(0,o.S)(n),tabIndex:-1}:{};return(0,r.jsx)("div",{className:"mm-header","data-auto-class":"mm-header",children:(0,r.jsx)("h1",{...c,id:i,children:(0,r.jsx)(s.Z,{tag:t,hasNoWrapper:!0,_previewMode:a})})})},i=a;a.__docgenInfo={description:"",methods:[],displayName:"Header",props:{tag:{required:!0,tsType:{name:"union",raw:"| GLOBAL_CONTENT_ITEMS\n| REFERRER_CONTENT_ITEMS\n| IFA_CONTENT_ITEMS\n| NPS_CONTENT_ITEMS\n| CHOICE_OF_OFFER_CONTENT_ITEMS\n| CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS\n| CUSTOMER_ORIGIN_SURVEY_ANSWERS",elements:[{name:"GLOBAL_CONTENT_ITEMS"},{name:"REFERRER_CONTENT_ITEMS"},{name:"IFA_CONTENT_ITEMS"},{name:"NPS_CONTENT_ITEMS"},{name:"CHOICE_OF_OFFER_CONTENT_ITEMS"},{name:"CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS"},{name:"union",raw:"| CUSTOMER_ORIGIN_SURVEY_ANSWERS_WITHOUT_OTHER\n| CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS.COS_ANSWER_OTHER",elements:[{name:"CUSTOMER_ORIGIN_SURVEY_ANSWERS_WITHOUT_OTHER"},{name:"CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS.COS_ANSWER_OTHER"}]}]},description:""},shouldAutoFocus:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},previewMode:{required:!1,tsType:{name:"PREVIEW_MODE"},description:""},id:{required:!1,tsType:{name:"string"},description:""}}}},"./src/consumer/journey/components/InformationNotice.tsx":function(e,t,n){n.d(t,{Z:function(){return a}});var r=n("../node_modules/react/jsx-runtime.js"),o=n("./src/consumer/journey/components/ContentItem.tsx");let s=e=>{let{tag:t}=e;return(0,r.jsxs)("div",{className:"mm-information-notice","data-auto-class":"mm-information-notice",children:[(0,r.jsx)("hr",{}),(0,r.jsx)(o.Z,{tag:t})]})},a=s;s.__docgenInfo={description:"",methods:[],displayName:"InformationNotice",props:{tag:{required:!0,tsType:{name:"union",raw:"| GLOBAL_CONTENT_ITEMS\n| REFERRER_CONTENT_ITEMS\n| IFA_CONTENT_ITEMS\n| NPS_CONTENT_ITEMS\n| CHOICE_OF_OFFER_CONTENT_ITEMS\n| CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS\n| CUSTOMER_ORIGIN_SURVEY_ANSWERS",elements:[{name:"GLOBAL_CONTENT_ITEMS"},{name:"REFERRER_CONTENT_ITEMS"},{name:"IFA_CONTENT_ITEMS"},{name:"NPS_CONTENT_ITEMS"},{name:"CHOICE_OF_OFFER_CONTENT_ITEMS"},{name:"CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS"},{name:"union",raw:"| CUSTOMER_ORIGIN_SURVEY_ANSWERS_WITHOUT_OTHER\n| CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS.COS_ANSWER_OTHER",elements:[{name:"CUSTOMER_ORIGIN_SURVEY_ANSWERS_WITHOUT_OTHER"},{name:"CUSTOMER_ORIGIN_SURVEY_CONTENT_ITEMS.COS_ANSWER_OTHER"}]}]},description:""}}}},"./src/consumer/journey/components/PageTransition.tsx":function(e,t,n){n.d(t,{Z:()=>l});var r=n("../node_modules/react/jsx-runtime.js"),o=n("../node_modules/react/index.js"),s=n("../node_modules/classnames/index.js"),a=n.n(s),i=n("../node_modules/react-transition-group/esm/CSSTransition.js");let c="data-stage",d=e=>{(0,o.useEffect)(()=>{let t=document.querySelector('[data-react-container="europium"]');if(!!t)return t.setAttribute(c,e),()=>{t.getAttribute(c)===e&&t.removeAttribute(c)}},[e])},u=e=>{let{children:t,className:n,dataStage:s,...c}=e,u=(0,o.useRef)(null);return d(s),(0,r.jsx)(i.Z,{nodeRef:u,appear:!0,in:!0,classNames:"pageTransition-forward",onEntering:()=>{let e=u.current,t=null==e?void 0:e.parentElement;if(e&&t){let n=e.clientHeight+parseInt(window.getComputedStyle(e).marginTop,10)+parseInt(window.getComputedStyle(e).marginBottom,10);t.style.height=`${n}px`,t.style.overflow="hidden"}},onEntered:()=>{var e;let t=null===(e=u.current)||void 0===e?void 0:e.parentElement;t&&(t.style.height="",t.style.overflow="")},addEndListener:e=>{setTimeout(()=>{var t;return null===(t=u.current)||void 0===t?void 0:t.addEventListener("transitionend",()=>e,!1)},0)},children:(0,r.jsx)("div",{ref:u,className:a()(n,s),...c,children:t})})},l=u;u.__docgenInfo={description:"",methods:[],displayName:"PageTransition"}},"./src/shared/constants/keyboardKeys.ts":function(e,t,n){n.d(t,{HF:function(){return s},KW:function(){return o},PC:function(){return a},tt:function(){return r}});let r="Enter",o="Escape",s="Tab",a=" "},"./src/shared/hooks/useFocusTrap/index.ts":function(e,t,n){n.d(t,{Z:()=>c,S:()=>i});var r=n("../node_modules/react/index.js"),o=n("./src/shared/constants/keyboardKeys.ts");let s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return Array.from(e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(e=>e.offsetWidth>0&&e.offsetHeight>0).filter(e=>!e.hasAttribute("disabled")).filter(e=>"-1"!==e.getAttribute("tabindex"))},a=(e,t)=>{if(e.key===o.HF){let n=s(t),r=n[0],o=n[n.length-1];e.shiftKey?e.target===r&&(e.preventDefault(),e.stopImmediatePropagation(),null==o||o.focus()):e.target===o&&(e.preventDefault(),e.stopImmediatePropagation(),null==r||r.focus())}},i=e=>({"data-autofocus":e}),c=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=(0,r.useRef)();(0,r.useEffect)(()=>{if(!t||!e.current)return;let r=e.current;document.hasFocus()&&(o.current=document.activeElement);let i=r.querySelector("[data-autofocus]")||s(r)[0];null==i||i.focus();let c=e=>{a(e,r)};return r.addEventListener("keydown",c),()=>{if(r.removeEventListener("keydown",c),n){var e;null===(e=o.current)||void 0===e||e.focus()}}},[t,e,n])}},"./src/shared/utilities/createFormClickHandler.ts":function(e,t,n){n.d(t,{Z:function(){return r}});let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{null==n||n.preventDefault();let r=document.createElement("form");r.setAttribute("method","post"),r.setAttribute("action",e),Object.entries(t).forEach(e=>{let[t,n]=e;if(!n)return;let o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",t),o.setAttribute("value",n),r.appendChild(o)}),document.body.appendChild(r),r.submit()}}}}]);