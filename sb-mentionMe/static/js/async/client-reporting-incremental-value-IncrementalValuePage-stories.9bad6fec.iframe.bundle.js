"use strict";(globalThis.webpackChunk_mention_me_frontend=globalThis.webpackChunk_mention_me_frontend||[]).push([["279"],{"./src/client/reporting/incremental-value/IncrementalValuePage.stories.tsx":function(e,n,t){t.r(n),t.d(n,{HasDataRevenue:()=>nh,AwaitingDataRevenue:()=>nf,default:()=>no,AwaitingDataMarketing:()=>nC,HasDataMarketing:()=>ng,InsufficientDataRevenue:()=>nv,NoFeatureAccessMarketing:()=>nx,NoFeatureAccessRevenue:()=>ny,InsufficientDataMarketing:()=>n_});var a=t("../node_modules/react/jsx-runtime.js"),r=t("../node_modules/react/index.js"),i=t("../node_modules/msw/lib/core/graphql.mjs"),s=t("../node_modules/msw/lib/core/HttpResponse.mjs"),l=t("./.storybook/preview.tsx"),o=t("./src/shared/@types/graphql.ts"),d=t("./src/client/reporting/hooks/ReportingContext.tsx");let c={__typename:"Query",merchant:{__typename:"Merchant",id:"4461",reportingCurrencySymbol:"\xa3",campaigns:{__typename:"CampaignConnection",edges:[{__typename:"Campaign",id:"15160",shortName:"1st order under \xa350",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15161",shortName:"1st order over \xa350",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15162",shortName:"2nd order under \xa3100",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15163",shortName:"2nd Order over \xa3100",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15185",shortName:"3+ orders",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15628",shortName:"4th Order",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15629",shortName:"3+ Orders",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15710",shortName:"Campaign 1",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15897",shortName:"IE (EUR) Propensity to Refer",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15899",shortName:"1st order, has been referred",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"15954",shortName:"UK (GBP) Promotional campaign en_GB",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"16342",shortName:"Not Opted in to newsletter",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"16800",shortName:"Promotional campaign",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"17888",shortName:"Campaign 2",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"13222",shortName:"UK (GBP) Landing Page",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"14080",shortName:"IE (EUR)",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"16341",shortName:"Student",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}},{__typename:"Campaign",id:"16704",shortName:"Propensity to refer",hasAnyChildExperimentConcluded:!0,incrementalValueMetrics:[{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferIncrementalRevenueRepeatRateGoal",type:o.mV.Currency,value:-5195.74848},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferAdditionalRevenueFromRepeatRepeatRateGoal",type:o.mV.Currency,value:-5078.43648},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferMissedReferralRevenueRepeatRateGoal",type:o.mV.Currency,value:117.31200000000001},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferCountOfDriveAction",type:o.mV.Number,value:7349},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferMissedReferralRevenueMarketingDatabaseGoal",type:o.mV.Currency,value:117.31200000000001}],experiments:{__typename:"ExperimentConnection",edges:[{__typename:"Experiment",id:"31488",status:"HAS_RUN",shortName:"Experiment 2",hasConcluded:!0},{__typename:"Experiment",id:"33244",status:"RUNNING",shortName:"Experiment 1",hasConcluded:!1}]}},{__typename:"Campaign",id:"17689",shortName:"Promotional campaign",incrementalValueMetrics:[],hasAnyChildExperimentConcluded:!1,experiments:{__typename:"ExperimentConnection",edges:[]}}]}}},m={__typename:"Query",merchant:{__typename:"Merchant",id:"4461",reportingCurrencySymbol:"\xa3",campaigns:{__typename:"CampaignConnection",edges:[{__typename:"Campaign",id:"16704",shortName:"Propensity to refer",incrementalValueMetrics:[{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferIncrementalRevenueRepeatRateGoal",type:o.mV.Currency,value:-5195.74848},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferAdditionalRevenueFromRepeatRepeatRateGoal",type:o.mV.Currency,value:-5078.43648},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferMissedReferralRevenueRepeatRateGoal",type:o.mV.Currency,value:117.31200000000001},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferCountOfDriveAction",type:o.mV.Number,value:7349},{__typename:"PropensityToReferCampaignIncrementalValueMetric",metricId:"MetricPropensityToReferMissedReferralRevenueMarketingDatabaseGoal",type:o.mV.Currency,value:117.31200000000001}],experiments:{__typename:"ExperimentConnection",edges:[{__typename:"Experiment",id:"33244",status:"RUNNING",shortName:"Experiment 1",hasConcluded:!1}]}}]}}},u={__typename:"Query",merchant:{__typename:"Merchant",id:"4461",reportingCurrencySymbol:"\xa3",campaigns:{__typename:"CampaignConnection",edges:[{__typename:"Campaign",id:"15160",shortName:"1st order under \xa350",hasAnyChildExperimentConcluded:!1,incrementalValueMetrics:[],experiments:{__typename:"ExperimentConnection",edges:[]}}]}}},p={__typename:"Query",merchant:{__typename:"Merchant",id:"4278",reportingCurrencySymbol:"\xa3",propensityToReferStats:{__typename:"PropensityToReferStats",repeatRevenueHeadlineMetrics:{__typename:"IncrementalValueHeadlineMetrics",startDate:"2021-01-01",endDate:"2021-01-31",primaryMetric:699061,secondaryMetric:744061,referralRevenueMissed:45e3},marketingDatabaseHeadlineMetrics:{__typename:"IncrementalValueHeadlineMetrics",startDate:"2021-01-01",endDate:"2021-01-31",primaryMetric:2756,secondaryMetric:2756,referralRevenueMissed:45e3}}}};var h=t("./src/client/reporting/incremental-value/__mocks__/fetchIncrementalValueStatistics.msw.ts");let g={__typename:"Query",merchant:{__typename:"Merchant",id:"123",propensityToReferSuitability:{__typename:"PropensityToReferSuitability",overallStatus:o.TQ.Ok,hasMerchantEnoughOrders:!0,orderCount:78479,estimatedOrderAvailibilty:null}}},y={__typename:"Query",merchant:{__typename:"Merchant",id:"123",propensityToReferSuitability:{__typename:"PropensityToReferSuitability",overallStatus:o.TQ.NotSuitable,hasMerchantEnoughOrders:!0,orderCount:78479,estimatedOrderAvailibilty:null}}},x={__typename:"Query",merchant:{__typename:"Merchant",id:"123",propensityToReferSuitability:{__typename:"PropensityToReferSuitability",overallStatus:o.TQ.InsufficientOrMissingData,hasMerchantEnoughOrders:!1,orderCount:4521,estimatedOrderAvailibilty:"2024-03-01 00:00:00"}}};var v=t("./src/client/reporting/incremental-value/context/IncrementalValuePageContext.ts"),_=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),f=t("../node_modules/nanoid/index.browser.js"),C=t("../node_modules/react-i18next/dist/es/index.js"),j=t("./src/shared/components/index.ts"),b=t("./src/shared/components/Table/index.ts"),E=t("../node_modules/@heroicons/react/24/solid/esm/ChevronDownIcon.js"),w=t("../node_modules/classnames/index.js"),S=t.n(w);let I="button-w3ieGj",M="disabledButton-xxBoCz",N="expanded-OZEdOS",R=e=>{let{row:n,disabled:t,title:r}=e,{t:i}=(0,C.$G)("shared");return(0,a.jsx)("button",{type:"button",...n.getToggleRowExpandedProps({className:S()(I,{[N]:n.isExpanded,[M]:t})}),disabled:t,title:r??(n.isExpanded?i("table.collapse","Collapse"):i("table.expand","Expand")),children:(0,a.jsx)(E.Z,{})})};R.Skeleton=()=>(0,a.jsx)(_.Od,{className:I,height:20,width:20});R.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"ExpansionCell"};var P=t("./src/shared/constants/helpPageDictionary.ts"),T=t("./src/shared/hooks/useTimePeriodTranslation/index.ts"),A=t("./src/shared/utilities/index.ts"),V=t("./src/client/reporting/incremental-value/IncrementalValue.types.ts"),k=t("../node_modules/@heroicons/react/24/solid/esm/InformationCircleIcon.js"),H=t("../node_modules/@heroicons/react/24/solid/esm/ArrowRightCircleIcon.js"),L=t("../node_modules/react-router-dom/esm/react-router-dom.js"),Z=t("./src/shared/hooks/index.ts"),W=t("./src/client/reporting/incremental-value/components/IncrementalValueOverTimeChart/IncrementalValueOverTimeChart.tsx"),O=t("./src/shared/components/StatusLabel/index.ts"),D=t("../node_modules/styled-components/dist/styled-components.browser.esm.js");let q=(0,D.ZP)(_.H5).withConfig({displayName:"IncrementalValueCampaignTableExperimentPopover.styled__Heading"})(["margin-bottom:",";"],(0,_.W0)(2)),B=(0,D.ZP)(_.BY).withConfig({displayName:"IncrementalValueCampaignTableExperimentPopover.styled__ExcludedButton"})(["display:flex;align-items:center;gap:",";"],(0,_.W0)(1)),F=D.ZP.div.withConfig({displayName:"IncrementalValueCampaignTableExperimentPopover.styled__ExperimentRow"})(["display:flex;align-items:center;gap:",";margin-bottom:",";"],(0,_.W0)(1),(0,_.W0)(1)),U=(0,D.ZP)(_.BY).attrs({as:L.OL}).withConfig({displayName:"IncrementalValueCampaignTableExperimentPopover.styled__Button"})(["text-align:left;flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"]),Q=e=>{let{id:n,shortName:t,status:r}=e,{merchantId:i}=(0,Z.rc)();return(0,a.jsxs)(F,{children:[(0,a.jsx)(U,{to:(0,A.nu)("fe_experiment_detail",{merchantId:i,experimentId:n}),children:t}),(0,a.jsx)(O.Z,{status:r,type:O.i.EXPERIMENT})]},n)},G=e=>{let{experiments:n}=e,{t}=(0,C.$G)("reporting"),r=(n||[]).filter(e=>{let{hasConcluded:n}=e;return n}),i=(n||[]).filter(e=>{let{hasConcluded:n}=e;return!n});return(0,a.jsxs)("div",{children:[(0,a.jsx)(q,{children:t("incremental-value.campaigns-table.experiment-popover.heading","Value is only calculated from experiments which have concluded within this campaign")}),(0,a.jsxs)(B,{as:"a",target:"_blank",rel:"noreferrer",href:P.W.INCREMENTAL_VALUE_UNCONCLUDED_EXPLAINER,children:[t("incremental-value.campaigns-table.why-explainer","Why exclude unconcluded experiments?"),(0,a.jsx)(H.Z,{width:16,height:16})]}),(0,a.jsx)("hr",{}),r.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q,{children:t("incremental-value.campaigns-table.experiment-popover.included-heading","Included experiments (which have concluded)")}),r.map(e=>{let{id:n,shortName:t,status:r}=e;return(0,a.jsx)(Q,{id:n,shortName:t,status:r},n)})]}),r.length>0&&i.length>0&&(0,a.jsx)("hr",{}),i.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(q,{children:t("incremental-value.campaigns-table.experiment-popover.excluded-heading","Excluded experiments (unconcluded experiments)")}),i.map(e=>{let{id:n,shortName:t,status:r}=e;return(0,a.jsx)(Q,{id:n,shortName:t,status:r},n)})]})]})},K=e=>{let{children:n,...t}=e;return(0,a.jsx)(_.u,{tooltip:(0,a.jsx)(G,{...t}),colourTheme:"light",children:n})};K.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueCampaignTableExperimentPopover"};let $=D.ZP.div.withConfig({displayName:"IncrementalValueCampaignTableSubRow.styled__Container"})(["display:flex;align-items:center;justify-content:space-between;gap:",";"],(0,_.W0)(1)),Y=D.ZP.div.withConfig({displayName:"IncrementalValueCampaignTableSubRow.styled__Actions"})(["display:flex;align-items:center;gap:",";"],(0,_.W0)(1)),z=(0,D.ZP)(_.zx).withConfig({displayName:"IncrementalValueCampaignTableSubRow.styled__Button"})(["display:flex;align-items:center;gap:",";white-space:nowrap;svg{width:",";height:",";}"],(0,_.W0)(1),(0,_.W0)(3),(0,_.W0)(3)),X=(0,D.ZP)(_.Lt).withConfig({displayName:"IncrementalValueCampaignTableSubRow.styled__Dropdown"})(["white-space:nowrap;"]),J=D.ZP.div.withConfig({displayName:"IncrementalValueCampaignTableSubRow.styled__OverTimeChart"})(["margin:",";"],(0,_.W0)([3,0])),ee=e=>{let{original:n,isExpanded:t}=e,{t:r}=(0,C.$G)("reporting"),{merchantId:i}=(0,Z.rc)();if(!n.id)return null;let s=r("incremental-value.campaigns-table.previous-experiments-link","{{count}} previous experiment",{count:n.previousExperimentsCount}),l=r("incremental-value.campaigns-table.live-experiments-link","{{count}} live experiment",{count:n.runningExperimentsCount});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)($,{children:[(0,a.jsx)("div",{children:n.hasWinner?(0,a.jsx)(K,{...n,children:(0,a.jsxs)(_.eg,{variant:"light",size:"sm",children:[(0,a.jsx)(_.eg.Icon,{children:(0,a.jsx)(k.Z,{width:16,height:16})}),(0,a.jsx)(_.eg.Body,{children:(0,a.jsx)(_.S,{children:(0,a.jsxs)(C.cC,{t:r,i18nKey:"incremental-value.campaigns-table.concluded-value-notification",children:["Calculating value from"," ",(0,a.jsx)(_.BY,{as:L.OL,to:(0,A.nu)("fe_campaign_show",{merchantId:i,campaignId:n.id,experimentStatus:"previous"}),children:(0,a.jsx)(a.Fragment,{children:{previousExperiments:s}})})," ","&"," ",(0,a.jsx)(_.BY,{as:L.OL,to:(0,A.nu)("fe_campaign_show",{merchantId:i,campaignId:n.id,experimentStatus:"current"}),children:(0,a.jsx)(a.Fragment,{children:{runningExperiments:l}})})]})})})]})}):(0,a.jsx)(K,{...n,children:(0,a.jsxs)(_.eg,{variant:"light",size:"sm",children:[(0,a.jsx)(_.eg.Icon,{children:(0,a.jsx)(k.Z,{width:16,height:16})}),(0,a.jsx)(_.eg.Body,{children:(0,a.jsx)(_.S,{children:r("incremental-value.campaigns-table.unconcluded-value-notification","Value cannot be calculated as no experiments have concluded in this campaign")})})]})})}),(0,a.jsxs)(Y,{children:[(0,a.jsx)(j.TE,{feature:"incremental-value-export",children:(0,a.jsx)(j.TE.On,{children:(0,a.jsxs)(X,{variant:"secondary",label:r("incremental-value.campaigns-table.export-customers.cta","Export customers"),children:[(0,a.jsx)(_.Lt.Button,{children:r("incremental-value.campaigns-table.export-customers.all","Export CSV of all customers")}),(0,a.jsx)(_.Lt.Divider,{}),(0,a.jsx)(_.Lt.Button,{children:r("incremental-value.campaigns-table.export-customers.high","Export CSV of High Propensity group")}),(0,a.jsx)(_.Lt.Button,{children:r("incremental-value.campaigns-table.export-customers.loew","Export CSV of Low Propensity group")})]})})}),(null==n?void 0:n.latestExperimentId)&&(0,a.jsxs)(z,{variant:"primary",forwardedAs:L.OL,to:(0,A.nu)("fe_experiment_detail",{merchantId:i,experimentId:n.latestExperimentId}),children:[r("incremental-value.campaigns-table.experiment-view","Latest experiment"),(0,a.jsx)(H.Z,{})]})]})]}),t&&(0,a.jsx)(J,{children:(0,a.jsx)(W.Z,{campaignId:n.id})})]})};ee.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueCampaignTableSubRow"};let en=(0,D.ZP)(_.$0).withConfig({displayName:"IncrementalValueCampaignTable.styled__Section"})(["margin-top:",";"],(0,_.W0)(3)),et=D.ZP.span.withConfig({displayName:"IncrementalValueCampaignTable.styled__PrimaryMetric"})(["color:",";font-size:20px;font-weight:700;"],(0,_.Ys)("NavyBase")),ea=(0,D.ZP)(j.iA).withConfig({displayName:"IncrementalValueCampaignTable.styled__Table"})(["margin-bottom:0;.table-narrow-x-padding{padding-left:8px;padding-right:8px;}.table-header-expand{width:20px;padding-left:0;padding-right:0;}.table-header-incremental-revenue,.table-header-estimated-referral-revenue-missed{width:205px;}.table-header-repeat-revenue{width:165px;}.table-header-new-sign-ups{width:145px;}.table-header-date{width:130px;}.table__row--no-data{padding:0 !important;}.table__row--subcomponent > td{border-top:none !important;}"]),er=[,,,].fill({}).map(()=>({id:(0,f.x0)()})),ei=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.campaigns-table"}),{timePeriod:n}=(0,d.eh)(),t=(0,T.Z)(n),{selectedGoal:i,hasFeatureAccess:s,upsellRequest:l,campaignsData:{data:c,loading:m,merchantCurrencySymbol:u},requestUpsell:p}=(0,v.t)(),h=(0,r.useMemo)(()=>i===V.r.REPEAT_REVENUE?[{id:"incrementalRevenue",accessor:"incrementalRevenue",className:"table-narrow-x-padding table-header-incremental-revenue",Header:()=>(0,a.jsxs)(a.Fragment,{children:[e("columns.incremental-revenue","Incremental revenue")," ",(0,a.jsx)(j.WW,{message:e("help.incremental-revenue","Incremental revenue is calculated by subtracting revenue you would have gotten from showing referral from the Repeat revenue generated by the Low Propensity to Refer group")})]}),Cell:n=>{let{value:t,row:r}=n;return(0,a.jsx)(et,{children:r.original.hasWinner?(0,A.qp)(t,{type:o.mV.Currency,currencySymbol:u||""}):(0,a.jsxs)(a.Fragment,{children:[e("unconcluded.not-available","Not available")," ",(0,a.jsx)(j.WW,{message:e("help.incremental-revenue-unconcluded","The experiments within this campaign have not concluded, we are not yet able to accurately calculate incremental value generated.")})]})})}},{id:"repeatRevenue",accessor:"repeatRevenue",className:"table-narrow-x-padding table-header-repeat-revenue",Header:()=>(0,a.jsxs)(a.Fragment,{children:[e("columns.repeat-revenue","Repeat revenue")," ",(0,a.jsx)(j.WW,{message:e("help.repeat-revenue","Repeat revenue is generated by the Low Propensity to Refer group who are shown an alternative action and go on to make another purchase")})]}),Cell:n=>{let{value:t,row:r}=n;return(0,a.jsx)(_.S,{children:r.original.hasWinner?(0,A.qp)(t,{type:o.mV.Currency,currencySymbol:u||""}):(0,a.jsxs)(a.Fragment,{children:[e("unconcluded.not-available","Not available")," ",(0,a.jsx)(j.WW,{message:e("help.repeat-revenue-unconcluded","We are not yet able to accurately calculate the increase in repeat revenue from showing an alternative action.")})]})})}}]:[{id:"newSignUps",accessor:"newSignUps",className:"table-narrow-x-padding table-header-new-sign-ups",Header:()=>(0,a.jsxs)(a.Fragment,{children:[e("columns.new-signups","New Sign Ups")," ",(0,a.jsx)(j.WW,{message:e("help.new-signups","The total number of Marketing opt-ins captured by showing the Low Propensity to Refer group a Newsletter sign-up message")})]}),Cell:e=>{let{value:n}=e;return(0,a.jsx)(et,{children:(0,A.qp)(n,{type:o.mV.Number})})}}],[i,e,u]),g=(0,r.useMemo)(()=>[{id:"expand",Cell:e=>(0,a.jsx)(R,{...e}),className:"table-header-expand"},{Header:e("columns.campaign-name","Campaign Name"),id:"shortName",accessor:"shortName",Cell:e=>{let{value:n}=e;return(0,a.jsx)(_.S,{children:n})}},{Header:e("columns.period","Period"),id:"period",className:"table-header-date",Cell:()=>(0,a.jsx)(_.S,{children:t})},...h,{id:"referralRevenueMissed",accessor:"referralRevenueMissed",className:"table-narrow-x-padding table-header-estimated-referral-revenue-missed",Header:()=>(0,a.jsxs)(a.Fragment,{children:[e("columns.referral-revenue-missed","Estimated referral revenue missed")," ",(0,a.jsx)(j.WW,{message:e("help.referral-revenue-missed","Revenue missed is the revenue you would have otherwise generated through referral if you had shown the Low Propensity to Refer group referral instead of an alternative action")})]}),Cell:n=>{let{row:t,value:r}=n;return(0,a.jsx)(_.S,{children:t.original.hasWinner?(0,A.qp)(r,{type:o.mV.Currency,currencySymbol:u||""}):(0,a.jsxs)(a.Fragment,{children:[e("unconcluded.not-available","Not available")," ",(0,a.jsx)(j.WW,{message:e("help.referral-revenue-missed-unconcluded","We are not yet able to accurately calculate what the referral revenue would have been if you had not shown an alternative action.")})]})})}}],[u,e,t,h]),y=(0,b.x)(g,m?er:c,{disableSortBy:!0});return(0,a.jsxs)(en,{"aria-labelledby":"value-driven-by-campaign-heading",children:[(0,a.jsx)(_.H3,{id:"value-driven-by-campaign-heading",children:e("heading","Value driven by the Low Propensity group broken down by campaign")}),(0,a.jsx)(_.Zb,{variant:"shadow",children:(0,a.jsx)(ea,{instance:y,loading:m,renderRowSubComponent:e=>(0,a.jsx)(ee,{...e}),noRowData:(0,a.jsx)(j.Jd,{title:e("empty.title","You are not running any Smart Experiment campaigns for this goal yet"),children:s?(0,a.jsx)(_.BY,{href:P.W.NEW_REQUEST_CAMPAIGN_SETUP,target:"_blank",rel:"noreferrer","data-ph":"incremental-value-set-up-campaign",children:e("empty.cta","Set one up now")}):(0,a.jsxs)(_.S,{children:[(0,a.jsx)(_.BY,{as:"button",onClick:()=>p(),disabled:l.hasRequestedUpsell,children:e("empty.cta-upgrade","Upgrade your package")})," ","to set one up"]})})})})]})};ei.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueCampaignTable"};var es=t("./src/client/reporting/incremental-value/components/IncrementalValueControls/IncrementalValueControls.tsx"),el=t("../node_modules/@apollo/client/react/hooks/useQuery.js"),eo=t("./src/client/reporting/incremental-value/graphql/fetchIncrementalValueHeadlineMetrics.generated.ts"),ed=t("./src/client/reporting/incremental-value/hooks/useIncrementalValueStatistics.ts"),ec=t("./src/client/reporting/incremental-value/components/IncrementalValueSegmentExplainerModal/components/IncrementalValuePropensityExplainerInfoBox.tsx"),em=t("./src/client/reporting/incremental-value/components/IncrementalValueSegmentExplainerModal/components/IncrementalValueSegmentationSplitChart.tsx"),eu=t("./src/client/reporting/incremental-value/components/IncrementalValueSegmentExplainerModal/components/IncrementalValueSegmentNewCustomersChart.tsx"),ep=t("./src/client/reporting/incremental-value/components/IncrementalValueSegmentExplainerModal/components/IncrementalValueSegmentProportionChart.tsx"),eh=t("./src/client/reporting/incremental-value/components/IncrementalValueSegmentExplainerModal/components/IncrementalValueSegmentRepeatRateChart.tsx"),eg=t("./src/client/reporting/incremental-value/components/IncrementalValueSegmentExplainerModal/IncrementalValueSegmentExplainerModal.tsx"),ey=t("./src/client/reporting/incremental-value/components/ExplainerLabel/ExplainerLabel.tsx");let ex=D.ZP.div.withConfig({displayName:"P2RExplainerChart.styled__Wrapper"})(["margin-top:",";","{display:grid;grid-template-columns:170px 1fr 170px;gap:",";}"],(0,_.W0)(3),(0,_.mq)("mdMin","min"),(0,_.W0)(2)),ev=(0,D.ZP)(_.XS).withConfig((0,_.NZ)("align")).withConfig({displayName:"P2RExplainerChart.styled__Label"})(["text-align:",";margin-top:15px;","{display:none;}"],e=>{let{align:n}=e;return n||"left"},(0,_.mq)("smMax","max")),e_=D.ZP.div.withConfig({displayName:"P2RExplainerChart.styled__Legend"})(["margin-top:",";display:flex;flex-direction:column;gap:",";","{display:none;}"],(0,_.W0)(3),(0,_.W0)(1),(0,_.mq)("mdMin","min")),ef=(0,D.ZP)("div").withConfig((0,_.NZ)("width")).withConfig({displayName:"P2RExplainerChart.styled__BarWrap"})(["position:relative;width:","%;flex:0 0 ","%;"],e=>{let{width:n}=e;return n},e=>{let{width:n}=e;return 100*n}),eC=(0,D.ZP)(_.Od).withConfig({displayName:"P2RExplainerChart.styled__BarSkeleton"})(["height:45px;"]),ej=(0,D.ZP)(_.XS).withConfig((0,_.NZ)("colors")).withConfig({displayName:"P2RExplainerChart.styled__Bar"})(["height:45px;width:100%;background:linear-gradient(180deg,"," 0%,"," 100%);box-shadow:0 3px 8px 0 rgb(0 0 0 / 25%);display:flex;align-items:center;justify-content:center;"],e=>{let{colors:n}=e;return n[0]},e=>{let{colors:n}=e;return n[1]}),eb=(0,D.ZP)(_.XS).withConfig({displayName:"P2RExplainerChart.styled__BarCaption"})(["color:",";","{display:none;}"],(0,_.Ys)("White"),(0,_.mq)("mdMin","min")),eE=D.ZP.div.withConfig({displayName:"P2RExplainerChart.styled__Bars"})(["display:flex;",":first-of-type ","{border-top-left-radius:",";border-bottom-left-radius:",";border-right:2px solid ",";}",":last-of-type ","{border-top-right-radius:",";border-bottom-right-radius:",";border-bottom-right-radius:0;border-left:2px solid ",";}"],ef,ej,(0,_.E0)("default"),(0,_.E0)("default"),(0,_.Ys)("White"),ef,ej,(0,_.E0)("default"),(0,_.E0)("default"),(0,_.Ys)("White")),ew=(0,D.ZP)(_.XS).withConfig({displayName:"P2RExplainerChart.styled__ExtraValueLabel"})(["border-radius:0 0 "," ",";border:1px dashed ",";border-top:none;background:linear-gradient(0deg,rgb(24 222 215 / 0%) 0%,rgb(24 222 215 / 24%) 100%);text-align:center;padding:",";font-weight:600;"],(0,_.E0)("default"),(0,_.E0)("default"),(0,_.Ys)("CyanBase"),(0,_.W0)(2)),eS=(0,D.ZP)(_.XS).withConfig({displayName:"P2RExplainerChart.styled__ControlLabel"})(["position:absolute;margin-top:17px;font-weight:600;white-space:nowrap;transform:translateX(-100%);left:50%;",'{display:none;}&::before{content:"";position:absolute;top:-17px;right:0;height:14px;width:2px;background:#5e76a3;}'],(0,_.mq)("smMax","max")),eI=e=>{let{name:n,value:t}=e;return(0,a.jsxs)(a.Fragment,{children:[n," - ",(0,a.jsx)("strong",{children:t})]})},eM=e=>(0,A.qp)(e,{type:o.mV.Percentage}),eN=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.p2r-explainer-chart"}),{colors:n}=(0,D.Fg)(),{statistics:t,loading:i}=(0,ed.Z)(),s=(0,r.useMemo)(()=>{if(!t)return;let{volume:e}=t;return{high:eM((null==e?void 0:e.high)||0),control:eM((null==e?void 0:e.control)||0),low:eM((null==e?void 0:e.low)||0)}},[t]);if(i||!t)return(0,a.jsx)(eN.Skeleton,{});let{volume:l}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ex,{"data-auto-class":"p2r-explainer-chart","aria-label":e("aria.chart-title","Bar chart illustrating the percentage of your customer base who are likely to refer and the percentage that are not likely to refer, using our Propensity to Refer model"),children:[(0,a.jsxs)(ev,{align:"right","aria-label":e("aria.high-propensity-label","The high propensity group is {{ percentage }} of your customer base",{percentage:null==s?void 0:s.high}),children:[e("label.high-propensity","High Propensity Group")," - ",(0,a.jsx)("strong",{children:null==s?void 0:s.high})]}),(0,a.jsxs)(eE,{children:[(0,a.jsx)(ef,{width:(null==l?void 0:l.high)||0,children:(0,a.jsx)(ej,{colors:[n.MidnightBlueBase,n.MidnightBlue80Dark],children:(0,a.jsx)(eb,{children:null==s?void 0:s.high})})}),(0,a.jsxs)(ef,{width:(null==l?void 0:l.control)||0,children:[(0,a.jsx)(ej,{colors:[n.MidnightBlue40Light,n.MidnightBlue70Light],children:(0,a.jsx)(eb,{children:null==s?void 0:s.control})}),(0,a.jsxs)(eS,{"aria-label":e("aria.control-group-label","The control group is {{ percentage }} of your customer base",{percentage:null==s?void 0:s.control}),children:[e("label.control","Control")," - ",null==s?void 0:s.control]})]}),(0,a.jsxs)(ef,{width:(null==l?void 0:l.low)||0,children:[(0,a.jsx)(ej,{colors:[n.CyanBase,n.Cyan80Dark],children:(0,a.jsx)(eb,{children:null==s?void 0:s.low})}),(0,a.jsx)(ew,{children:e("label.extra-value","Driving extra value")})]})]}),(0,a.jsxs)(ev,{"aria-label":e("aria.low-propensity-label","The low propensity group is {{ percentage }} of your customer base. These customers are driving extra value to your business.",{percentage:null==s?void 0:s.low}),children:[(0,a.jsx)("strong",{children:null==s?void 0:s.low})," - ",e("label.low-propensity","Low Propensity Group")]})]}),(0,a.jsxs)(e_,{children:[(0,a.jsx)(ey.Z,{color:"MidnightBlueBase",text:(0,a.jsx)(eI,{name:e("label.high-propensity","High Propensity Group"),value:null==s?void 0:s.high})}),(0,a.jsx)(ey.Z,{color:"MidnightBlue40Light",text:(0,a.jsx)(eI,{name:e("label.control","Control"),value:null==s?void 0:s.control})}),(0,a.jsx)(ey.Z,{color:"CyanBase",text:(0,a.jsx)(eI,{name:e("label.low-propensity","Low Propensity Group"),value:null==s?void 0:s.low})})]})]})};eN.Skeleton=()=>(0,a.jsxs)(ex,{"aria-live":"polite",children:[(0,a.jsx)(ev,{align:"right",children:(0,a.jsx)(_.Od,{width:100})}),(0,a.jsx)(eE,{children:(0,a.jsx)(ef,{width:1,children:(0,a.jsx)(eC,{width:"100%"})})}),(0,a.jsx)(ev,{children:(0,a.jsx)(_.Od,{width:100})})]}),eN.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"P2RExplainerChart"};let eR=(0,D.ZP)(_.UQ).withConfig({displayName:"IncrementalValueP2RExplainerAccordion.styled__Accordion"})(["margin-top:",";"],(0,_.W0)(1)),eP=(0,D.ZP)(_.S).withConfig({displayName:"IncrementalValueP2RExplainerAccordion.styled__Copy"})(["margin-bottom:",";"],(0,_.W0)(2)),eT=D.ZP.div.withConfig({displayName:"IncrementalValueP2RExplainerAccordion.styled__ButtonWrap"})(["display:flex;justify-content:end;margin-top:",";"],(0,_.W0)(3)),eA=D.ZP.div.withConfig({displayName:"IncrementalValueP2RExplainerAccordion.styled__Container"})(["margin-top:",";display:grid;gap:",";"],(0,_.W0)(3),(0,_.W0)(2)),eV=D.ZP.div.withConfig({displayName:"IncrementalValueP2RExplainerAccordion.styled__ChartContainer"})(["display:grid;gap:",";grid-template-columns:auto;","{grid-template-columns:repeat(2,0.5fr);}"],(0,_.W0)(2),(0,_.mq)("mdMin","min")),ek=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.explainer-accordion"}),{statistics:n,loading:t}=(0,ed.Z)(),{isAwaitingData:i}=(0,v.t)(),s=(0,r.useMemo)(()=>{var r;if(t)return(0,a.jsx)(_.Od,{width:"100%"});if(!n)return null;let i=null==n?void 0:null===(r=n.volume)||void 0===r?void 0:r.low;return e("copy","Our Propensity to Refer model is segmenting your customer base into those likely to refer and those unlikely to refer. The Model has correctly identified (at post-purchase) {{ percentage }} of your customers are unlikely to refer. We can then use this {{ percentage }} of customers to drive extra value in the form of Incremental repeat revenue, Marketing contacts or Optimising referral revenue.",{percentage:(0,A.qp)(i,{type:o.mV.Percentage})})},[e,t,n]);return(0,a.jsxs)(eR,{variant:"single",id:"incremental-value-explainer-accordion",isDefaultExpanded:i,children:[(0,a.jsx)(_.UQ.Label,{children:(0,a.jsx)(_.H5,{children:e("tile-heading","How Propensity to Refer is powering Smart Experiments to segment your customers")})}),(0,a.jsxs)(_.UQ.Content,{children:[(0,a.jsx)(eP,{children:s}),(0,a.jsx)(eN,{}),i?(0,a.jsxs)(eA,{children:[(0,a.jsx)(_.H5,{children:e("tile-subheading","Looking at the performance of each of the segments after PTR has allocated customers correctly")}),(0,a.jsxs)(eV,{children:[(0,a.jsx)(em.Z,{}),(0,a.jsx)(eu.Z,{}),(0,a.jsx)(ep.Z,{}),(0,a.jsx)(eh.Z,{})]}),(0,a.jsx)(ec.Z,{})]}):(0,a.jsx)(eT,{children:(0,a.jsx)(eg.Z,{})})]})]})};ek.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueP2RExplainerAccordion"};let eH=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics"}),{selectedGoal:n}=(0,v.t)();return(0,a.jsx)(a.Fragment,{children:e("subheading","Overall Incremental revenue",{context:n})})};eH.__docgenInfo={description:"",methods:[],displayName:"HeadlineMetricsHeading"};var eL=t("../node_modules/@heroicons/react/24/outline/esm/LightBulbIcon.js"),eZ=t("./src/client/reporting/incremental-value/components/IncrementalValueCalculationModal/IncrementalValueCalculationModal.tsx"),eW=t("../node_modules/@heroicons/react/24/outline/esm/QuestionMarkCircleIcon.js");(0,_.W0)(3);let eO=D.ZP.div.withConfig({displayName:"HeadlingMetricsCardBody.styled__Values"})(["display:grid;margin-top:16px;grid-template-columns:repeat(auto-fit,minmax(470px,1fr));gap:",";margin-bottom:",";","{margin-bottom:",";}"],(0,_.W0)(2),(0,_.W0)(2),(0,_.mq)("mdMin","min"),(0,_.W0)(4)),eD=D.ZP.div.withConfig({displayName:"HeadlingMetricsCardBody.styled__SubValues"})(["display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:",";"],(0,_.W0)(2)),eq=D.ZP.div.withConfig({displayName:"HeadlingMetricsCardBody.styled__SubValue"})(["display:flex;flex-direction:column;gap:",";"],(0,_.W0)(1)),eB=D.ZP.div.withConfig({displayName:"HeadlingMetricsCardBody.styled__SubValueTitle"})(["display:flex;gap:",";"],(0,_.W0)(.5)),eF=(0,D.ZP)(_.M).withConfig({displayName:"HeadlingMetricsCardBody.styled__SubValueMetric"})(["font-weight:500;font-size:32px;"]),eU=D.ZP.span.withConfig({displayName:"HeadlingMetricsCardBody.styled__PrimaryMetricValue"})(["font-size:64px;font-weight:500;vertical-align:middle;"]),eQ=(0,D.ZP)(_.S).withConfig({displayName:"HeadlingMetricsCardBody.styled__Caption"})(["margin-bottom:",";"],(0,_.W0)(2)),eG=D.ZP.span.withConfig({displayName:"HeadlingMetricsCardBody.styled__AwaitingData"})(["display:flex;align-items:center;gap:",";"],(0,_.W0)(2)),eK=(0,D.ZP)(eW.Z).withConfig({displayName:"HeadlingMetricsCardBody.styled__TooltipIcon"})(["width:20px;height:20px;vertical-align:middle;"]),e$=e=>"number"==typeof e,eY=e=>{let{headlineMetrics:n,currencySymbol:t,isIllustrative:i}=e,{t:s}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics"}),{selectedGoal:l,isAwaitingData:d}=(0,v.t)(),{primaryMetric:c,secondaryMetric:m,referralRevenueMissed:u}=n||{},p=(0,r.useCallback)(e=>(0,_.xG)(e,{currencySymbol:t,mode:"compact"}),[t]),h=(0,r.useCallback)(e=>l===V.r.REPEAT_REVENUE?p(e):(0,A.qp)(e,{type:o.mV.Number}),[l,p]),g=(0,r.useMemo)(()=>d?(0,a.jsxs)(eG,{children:[s("awaiting-data.copy","Awaiting Data"),(0,a.jsx)(_.u,{tooltip:(0,a.jsxs)(C.cC,{i18nKey:"awaiting-data.tooltip",children:[(0,a.jsx)(_.S,{children:"Neither the Share rate nor Repeat rate tests within your running Smart Experiments (for all of your campaigns) have reached conclusion yet. So we have not been able to calculate overall value being generated by these experiments."}),(0,a.jsx)("br",{}),(0,a.jsx)(_.S,{children:'Once we have conclusive results from these tests we will be able to calculate value generated, please check back again later."'})]}),children:(0,a.jsx)(eK,{})})]}):e$(c)?h(c):s("headline-metric.no-data","No data"),[d,c,s,h]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eO,{children:[(0,a.jsx)(j.Jn.Value,{value:(0,a.jsx)(eU,{"data-auto-class":"incremental-value-headline-primary-metric",children:g})}),(0,a.jsxs)(eD,{children:[(0,a.jsxs)(eq,{children:[(0,a.jsxs)(eB,{children:[(0,a.jsx)(_.S,{children:s("secondary-metric","Additional repeat revenue",{context:l})}),(0,a.jsx)(j.WW,{message:s("help.secondary-metric","Additional repeat revenue generated through showing the low propensity group an alternative offer to referral",{context:l})})]}),(0,a.jsx)(eF,{children:e$(m)&&!d?h(m):"-"})]}),(0,a.jsxs)(eq,{children:[(0,a.jsxs)(eB,{children:[(0,a.jsx)(_.S,{children:s("revenue-missed","Estimated Referral revenue missed")}),(0,a.jsx)(j.WW,{message:s("help.revenue-missed","Revenue missed is the revenue you would have otherwise generated through referral if you had shown the Low Propensity to Refer group referral instead of an alternative action")})]}),(0,a.jsx)(eF,{children:e$(u)&&!d?p(u):"-"})]})]})]}),(0,a.jsx)(eQ,{children:s("summary-copy","How much additional revenue generated by showing customers with a Low Propensity to Refer an alternative action to Referral in order to get them to repeat purchase.",{context:l})}),l===V.r.REPEAT_REVENUE&&(0,a.jsx)(eZ.Z,{isDisabled:i})]})};eY.Skeleton=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(eO,{children:[(0,a.jsx)(j.Jn.Value,{value:(0,a.jsx)(_.Od,{width:150,height:57})}),(0,a.jsxs)(eD,{children:[(0,a.jsxs)(eq,{children:[(0,a.jsx)(_.Od,{width:150,height:12}),(0,a.jsx)(_.Od,{width:50,height:28})]}),(0,a.jsxs)(eq,{children:[(0,a.jsx)(_.Od,{width:150,height:12}),(0,a.jsx)(_.Od,{width:70,height:28})]})]})]}),(0,a.jsxs)(eQ,{children:[(0,a.jsx)(_.Od,{width:"50%"}),(0,a.jsx)("br",{}),(0,a.jsx)(_.Od,{width:"40%"})]})]}),eY.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"HeadlineMetricsCardBody",props:{headlineMetrics:{required:!1,tsType:{name:"IncrementalValueHeadlineMetrics"},description:""},currencySymbol:{required:!1,tsType:{name:"string"},description:""},isIllustrative:{required:!1,tsType:{name:"boolean"},description:""}}};let ez=(0,D.ZP)(_.Zb).withConfig({displayName:"HeadlineMetricsInsufficientData.styled__Card"})(["display:grid;gap:",";"],(0,_.W0)(2)),eX=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics.insufficient-data"}),{isAwaitingData:n,selectedGoal:t}=(0,v.t)();return(0,a.jsxs)(ez,{children:[!n&&(0,a.jsx)(_.eg,{variant:"info",isFullWidth:!0,children:(0,a.jsx)(_.eg.Body,{children:(0,a.jsxs)(_.S,{children:[e("no-experiments-notice","You are not running any Smart Experiments with this goal.",{context:t})," ",(0,a.jsx)(_.BY,{href:P.W.NEW_REQUEST_CAMPAIGN_SETUP,target:"_blank",rel:"noreferrer","data-ph":"incremental-value-set-up-campaign",children:e("create-campaign-cta","Set one up now")})]})})}),(0,a.jsxs)(_.Zb,{variant:"layout-only",children:[(0,a.jsx)(_.Zb.Title,{children:(0,a.jsx)(eH,{})}),!n&&(0,a.jsx)(_.Zb.Info,{children:(0,a.jsx)(_.S,{children:e("no-campaigns","No campaigns running")})}),(0,a.jsx)(_.Zb.Body,{children:(0,a.jsx)(eY,{})})]}),(0,a.jsxs)(_.eg,{variant:"dark",isFullWidth:!0,children:[(0,a.jsx)(_.eg.Icon,{children:(0,a.jsx)(eL.Z,{})}),(0,a.jsx)(_.eg.Body,{children:(0,a.jsxs)(_.S,{children:[e("learn-segmentation-notice","Smart Experiments is powered by the Propensity to Refer\xae machine learning model.")," ",(0,a.jsx)(_.BY,{as:"a",target:"_blank",rel:"noreferrer",href:P.W.INCREMENTAL_VALUE_HOW_P2R_WORKS,children:e("no-experiments-button","Learn how it segments your customers")})]})})]})]})};eX.__docgenInfo={description:"",methods:[],displayName:"HeadlineMetricsInsufficientData"};let eJ=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics.no-data"});return(0,a.jsx)(_.Zb,{children:(0,a.jsx)(j.Jd,{title:e("heading","There's been a problem loading your incremental value data"),children:(0,a.jsx)(_.M,{children:e("caption","Please contact your account manager")})})})};eJ.__docgenInfo={description:"",methods:[],displayName:"HeadlineMetricsNoData"};var e0=t("./src/shared/components/DashboardLayout/DashboardLayout.styled.tsx"),e1=t("../node_modules/@heroicons/react/20/solid/esm/ArrowUpCircleIcon.js");let e2=(0,D.ZP)(_.Zb).withConfig({displayName:"HeadlineMetricsUpgrade.styled__Card"})(["margin-top:",";margin-bottom:",";> *{opacity:0.3;}"],(0,_.W0)(2),(0,_.W0)(2)),e5=(0,D.ZP)(e1.Z).withConfig({displayName:"HeadlineMetricsUpgrade.styled__ArrowIcon"})(["width:40px;height:40px;fill:",";"],(0,_.Ys)("NavyBase")),e3=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics.upgrade"}),{upsellRequest:n,requestUpsell:t}=(0,v.t)();return(0,a.jsxs)(_.Zb,{children:[(0,a.jsxs)(e0.Jd,{children:[(0,a.jsx)(e5,{}),(0,a.jsx)(_.H4,{children:e("upsell-heading","Increase Repeat revenue along side generating referral revenue with Smart Experiments")}),(0,a.jsx)(_.M,{children:e("upsell-copy","Upgrade your package to use Smart Experiments powered by Propensity to Refer\xae to increase Repeat revenue by segmenting your customers. Our Machine learning model drives those who are likely to refer their friends' to do so and those 'unlikely to refer' to purchase again.")}),(0,a.jsx)(_.zx,{"data-ph":"incremental-value-upgrade-button",variant:"secondary",onClick:()=>t(),isLoading:n.isRequestingUpsell,disabled:n.hasRequestedUpsell,children:e("upsell-button","Contact us to upgrade")})]}),(0,a.jsxs)(e2,{variant:"layout-only",children:[(0,a.jsx)(_.Zb.Title,{children:(0,a.jsx)(eH,{})}),(0,a.jsx)(_.Zb.Info,{children:(0,a.jsx)(_.S,{children:e("no-campaigns","No campaigns running")})}),(0,a.jsx)(_.Zb.Body,{children:(0,a.jsx)(eY,{headlineMetrics:{startDate:"2021-01-01",endDate:"2021-01-31",primaryMetric:0,secondaryMetric:0,referralRevenueMissed:0},currencySymbol:"\xa3",isIllustrative:!0})})]}),(0,a.jsxs)(_.eg,{variant:"dark",isFullWidth:!0,children:[(0,a.jsx)(_.eg.Icon,{children:(0,a.jsx)(eL.Z,{})}),(0,a.jsx)(_.eg.Body,{children:(0,a.jsxs)(_.S,{children:[e("learn-segmentation-notice","Smart Experiments is powered by the Propensity to Refer\xae machine learning model.")," ",(0,a.jsx)(_.BY,{as:"a",target:"_blank",rel:"noreferrer",href:P.W.INCREMENTAL_VALUE_HOW_P2R_WORKS,children:e("segment-explainer-button","Learn how it segments your customers")})]})})]})]})};e3.__docgenInfo={description:"",methods:[],displayName:"HeadlineMetricsUpgrade"};let e4=()=>{var e,n,t,i,s;let{merchantId:l}=(0,Z.rc)(),{t:o}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics"}),{selectedGoal:c,selectedRepeatWindow:m,hasFeatureAccess:u,isLoadingFeatureAccess:p,campaignsData:{loading:h,data:g}}=(0,v.t)(),{timePeriod:y}=(0,d.eh)(),{data:x,loading:f}=(0,el.aM)(eo.L,{variables:{merchantId:l,timePeriod:y,repeatWindow:c===V.r.REPEAT_REVENUE?m:void 0}}),j=(0,r.useMemo)(()=>{var e,n,t,a;switch(c){case V.r.REPEAT_REVENUE:return null==x?void 0:null===(n=x.merchant)||void 0===n?void 0:null===(e=n.propensityToReferStats)||void 0===e?void 0:e.repeatRevenueHeadlineMetrics;case V.r.MARKETING_DATABASE:return null==x?void 0:null===(a=x.merchant)||void 0===a?void 0:null===(t=a.propensityToReferStats)||void 0===t?void 0:t.marketingDatabaseHeadlineMetrics;default:return}},[null==x?void 0:null===(n=x.merchant)||void 0===n?void 0:null===(e=n.propensityToReferStats)||void 0===e?void 0:e.marketingDatabaseHeadlineMetrics,null==x?void 0:null===(i=x.merchant)||void 0===i?void 0:null===(t=i.propensityToReferStats)||void 0===t?void 0:t.repeatRevenueHeadlineMetrics,c]);if(!u&&!p)return(0,a.jsx)(e3,{});if(!h&&!(null==g?void 0:g.length))return(0,a.jsx)(eX,{});if(f||h||p)return(0,a.jsx)(e4.Skeleton,{});if(!j)return(0,a.jsx)(eJ,{});let{startDate:b,endDate:E}=j;return(0,a.jsxs)(_.Zb,{children:[(0,a.jsx)(_.Zb.Title,{children:(0,a.jsx)(eH,{})}),(0,a.jsx)(_.Zb.Info,{children:(0,a.jsx)(_.S,{children:(0,a.jsxs)(C.cC,{t:o,i18nKey:"time-period",children:["Calculated from ",(0,a.jsx)("strong",{children:{startDate:(0,_.p6)(b)}})," to"," ",(0,a.jsx)("strong",{children:{endDate:(0,_.p6)(E)}})]})})}),(0,a.jsx)(_.Zb.Body,{children:(0,a.jsx)(eY,{headlineMetrics:j,currencySymbol:null==x?void 0:null===(s=x.merchant)||void 0===s?void 0:s.reportingCurrencySymbol})}),(0,a.jsx)(_.Zb.Footer,{children:(0,a.jsx)(ek,{})})]})};e4.Skeleton=()=>(0,a.jsxs)(_.Zb,{children:[(0,a.jsx)(_.Zb.Title,{children:(0,a.jsx)(_.Od,{width:250,height:23})}),(0,a.jsx)(_.Zb.Info,{children:(0,a.jsx)(_.Od,{width:260})}),(0,a.jsx)(_.Zb.Body,{children:(0,a.jsx)(eY.Skeleton,{})})]}),e4.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"HeadlineMetricsCard"};let e7=(0,D.ZP)(_.$0).withConfig({displayName:"IncrementalValueHeadlineMetrics.styled__Section"})(["margin-top:",";"],(0,_.W0)(3)),e6=()=>{let{t:e}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.headline-metrics"}),{selectedGoal:n}=(0,v.t)();return(0,a.jsxs)(e7,{children:[(0,a.jsx)(_.H3,{children:e("heading","Overall Repeat revenue driven by the Low Propensity group",{context:n})}),(0,a.jsx)(e4,{})]})};e6.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueHeadlineMetrics"};let e8=()=>{var e;let{t:n}=(0,C.$G)("reporting"),{hasFeatureAccess:t,isLoadingFeatureAccess:r}=(0,v.t)(),{statistics:i,loading:s}=(0,ed.Z)();return(0,a.jsxs)(j.CD,{children:[(0,a.jsx)(j.CD.Title,{children:n("incremental-value.heading.title","Incremental value from Propensity to Refer\xae")}),!r&&t&&(0,a.jsx)(j.CD.Subtitle,{children:s?(0,a.jsx)(_.Od,{width:650}):(0,a.jsxs)(C.cC,{t:n,i18nKey:"incremental-value.heading.subtitle",children:["Extra value we’re driving from the"," ",{value:(0,_.rl)((null==i?void 0:null===(e=i.volume)||void 0===e?void 0:e.low)||0)}," of your customers at post-purchase who aren’t referring"]})})]})};e8.__docgenInfo={description:"",methods:[],displayName:"IncrementalValuePageHeading"};let e9=r.forwardRef(function({title:e,titleId:n,...t},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"}))});var ne=t("../node_modules/@heroicons/react/24/solid/esm/QuestionMarkCircleIcon.js");let nn=(0,D.ZP)(_.eg).withConfig({displayName:"IncrementalValueQualificationNotice.styled__InformationBox"})(["margin-bottom:",";"],(0,_.W0)(3)),nt=D.ZP.span.withConfig({displayName:"IncrementalValueQualificationNotice.styled__TooltipLabel"})(["svg{width:16px;height:16px;fill:currentcolor;}"]),na=()=>{var e;let{t:n}=(0,C.$G)("reporting",{keyPrefix:"incremental-value.unhappy.low-orders"}),{suitabilityData:t,isSuitabilityLoading:r,hasFeatureAccess:i,campaignsData:s}=(0,v.t)(),{estimatedOrderAvailibilty:l,hasMerchantEnoughOrders:d,orderCount:c,overallStatus:m}=(null==t?void 0:null===(e=t.merchant)||void 0===e?void 0:e.propensityToReferSuitability)||{};return!r&&!(null==s?void 0:s.loading)&&!d&&i&&m!==o.TQ.NotSuitable?(0,a.jsxs)(nn,{size:"lg",variant:"warning",children:[(0,a.jsx)(_.eg.Icon,{children:(0,a.jsx)(e9,{})}),(0,a.jsx)(_.eg.Body,{children:(0,a.jsxs)(_.al,{children:[(0,a.jsx)(_.H5,{children:n("title","You need at least 10,000 orders from enrolled customers to use Smart Experiments")}),(0,a.jsx)(_.M,{children:n("subtitle","We need at least 10,000 orders from your enrolled customers for the Propensity to Refer model to be able to begin accurately segmenting your customer base. Based on your current purchase rate you should have accrued enough purchases within around 100 days.")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(_.M,{children:[(0,a.jsx)("strong",{children:n("order-count.title","Number of orders:")})," ",(0,_.uf)(c||0)," / ",(0,_.uf)(1e4)]}),(0,a.jsxs)(_.M,{children:[(0,a.jsx)("strong",{children:n("estimate.title","Estimated availability date:")})," ",l?(0,_.p6)(l):n("date-not-calculated","Not yet calculated")," ",(0,a.jsx)(_.u,{tooltip:n("estimate.tooltip","This date is estimated based on your current purchase rate. Actual time taken to accrue enough orders could vary depending on your own marketing activities."),children:(0,a.jsx)(nt,{role:"tooltip","aria-label":"low-orders-help-icon",children:(0,a.jsx)(ne.Z,{})})})]})]})]})})]}):null};na.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueQualificationNotice"};let nr=(0,D.ZP)(_.Zb).withConfig({displayName:"IncrementalValuePageBody.styled__OverTimeCard"})(["margin-top:",";"],(0,_.W0)(2)),ni=()=>{let{hasFeatureAccess:e,isLoadingFeatureAccess:n,campaignsData:{loading:t,data:r},isAwaitingData:i}=(0,v.t)();return(e||n)&&(t||(null==r?void 0:r.length))&&!i?(0,a.jsx)(nr,{children:(0,a.jsx)(W.Z,{isLoading:n||t})}):null},ns=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e8,{}),(0,a.jsx)(na,{}),(0,a.jsx)(es.Q,{}),(0,a.jsx)(e6,{}),(0,a.jsx)(ni,{}),(0,a.jsx)(ei,{})]});ns.__docgenInfo={description:"",methods:[],displayName:"IncrementalValuePageBody"};var nl=t("./src/client/reporting/incremental-value/context/IncrementalValuePageProvider.tsx");let no={component:ns,title:"Portal / Reporting / Incremental Value / Incremental Value Page",decorators:[e=>(0,a.jsx)("div",{style:{maxWidth:"1200px"},children:e()})],parameters:{chromatic:{disableSnapshot:!0},msw:{handlers:[i.B.query("merchant",()=>s.Z.json({data:{__typename:"Query",merchant:{__typename:"Merchant",id:"1234",reportingCurrencySymbol:"\xa3"}}}))]}}},nd=e=>{l.server.use(i.B.query("merchantFeatures",()=>s.Z.json({data:{__typename:"Query",merchant:{__typename:"Merchant",id:"1234",featureAccess:[{__typename:"MerchantFeatureAccess",accessState:e,id:"smart_experiment_drive_action"}]}}})))},nc=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"happy",n=()=>"not-suitable"===e?y:"invalid-orders"===e?x:g;l.server.use(i.B.query("fetchIncrementalValueSuitability",()=>s.Z.json({data:n()})))},nm=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=()=>e?n?c:m:u;l.server.use(i.B.query("fetchIncrementalValueCampaigns",()=>s.Z.json({data:t()})))},nu=e=>{let{goal:n}=e,{updateGoal:t}=(0,v.t)();return(0,r.useEffect)(()=>{n&&t(n,!1)},[n,t]),(0,a.jsx)("div",{style:{width:"100%"},children:(0,a.jsx)(ns,{})})},np=e=>{let{driveActionAccessState:n=o.PS.HasAccess,hasExperimentWinner:t=!0,hasCampaignData:r,goal:c,suitability:m="happy"}=e;return nd(n),nc(m),nm(r,t),l.server.use(i.B.query("fetchIncrementalValueHeadlineMetrics",()=>s.Z.json({data:p}))),l.server.use(i.B.query("fetchIncrementalValueStatistics",()=>s.Z.json({data:h.m}))),(0,a.jsx)(d.U,{children:(0,a.jsx)(nl.p,{children:(0,a.jsx)(nu,{goal:c})})})},nh=np.bind({}),ng=np.bind({});ng.args={goal:V.r.MARKETING_DATABASE};let ny=np.bind({});ny.args={driveActionAccessState:o.PS.NoAccess};let nx=np.bind({});nx.args={goal:V.r.MARKETING_DATABASE,driveActionAccessState:o.PS.NoAccess};let nv=np.bind({});nv.args={hasCampaignData:!1,suitability:"invalid-orders"};let n_=np.bind({});n_.args={goal:V.r.MARKETING_DATABASE,hasCampaignData:!1};let nf=np.bind({});nf.args={hasCampaignData:!0,hasExperimentWinner:!1};let nC=np.bind({});nC.args={goal:V.r.MARKETING_DATABASE,hasCampaignData:!0,hasExperimentWinner:!1},nh.parameters={...nh.parameters,docs:{...nh.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...nh.parameters?.docs?.source}}},ng.parameters={...ng.parameters,docs:{...ng.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...ng.parameters?.docs?.source}}},ny.parameters={...ny.parameters,docs:{...ny.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...ny.parameters?.docs?.source}}},nx.parameters={...nx.parameters,docs:{...nx.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...nx.parameters?.docs?.source}}},nv.parameters={...nv.parameters,docs:{...nv.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...nv.parameters?.docs?.source}}},n_.parameters={...n_.parameters,docs:{...n_.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...n_.parameters?.docs?.source}}},nf.parameters={...nf.parameters,docs:{...nf.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...nf.parameters?.docs?.source}}},nC.parameters={...nC.parameters,docs:{...nC.parameters?.docs,source:{originalSource:'({\n  driveActionAccessState = AccessEnum.HasAccess,\n  hasExperimentWinner = true,\n  hasCampaignData,\n  goal,\n  suitability = "happy"\n}) => {\n  featureAccessQuery(driveActionAccessState);\n  suitabilityQuery(suitability);\n  campaignsQuery(hasCampaignData, hasExperimentWinner);\n  server.use(graphql.query("fetchIncrementalValueHeadlineMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_HEADLINE_METRICS_RESPONSE\n    });\n  }));\n  server.use(graphql.query("fetchIncrementalValueStatistics", () => {\n    return HttpResponse.json({\n      data: MOCK_INCREMENTAL_VALUE_STATISTICS\n    });\n  }));\n  return <ReportingProvider>\n            <IncrementalValuePageProvider>\n                <Content goal={goal} />\n            </IncrementalValuePageProvider>\n        </ReportingProvider>;\n}',...nC.parameters?.docs?.source}}}},"./src/client/reporting/incremental-value/components/IncrementalValueCalculationModal/IncrementalValueCalculationModal.tsx":function(e,n,t){t.d(n,{Z:()=>v});var a=t("../node_modules/react/jsx-runtime.js"),r=t("../node_modules/react/index.js"),i=t("../node_modules/@heroicons/react/24/solid/esm/ArrowRightCircleIcon.js"),s=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),l=t("../node_modules/react-i18next/dist/es/index.js"),o=t("./src/shared/hooks/useZendeskWidget/index.ts"),d=t("./src/client/reporting/incremental-value/hooks/useIncrementalValueStatistics.ts"),c=t("./src/client/reporting/incremental-value/components/ChartCard/ChartCard.tsx"),m=t("./src/client/reporting/incremental-value/components/DonutPieChart/DonutPieChart.tsx");let u=(0,t("../node_modules/styled-components/dist/styled-components.browser.esm.js").ZP)(s.BY).attrs({as:"button"}).withConfig({displayName:"IncrementalValueCalculationModal.styled__Button"})(["display:flex;align-items:center;gap:",";svg{width:18px;height:18px;}","{white-space:nowrap;}"],(0,s.W0)(1),(0,s.mq)("mdMin","min")),p=t.p+"static/image/static/media/Formula.5ab6b4ae.png",h=t.p+"static/image/static/media/FormulaWithControl.7025b85f.png",g=t.p+"static/image/static/media/RepeatRevenueFormula.7e3a6bd3.png",y="incremental-value-calculation-cta",x=e=>{let{isDisabled:n}=e,{t}=(0,l.$G)("reporting",{keyPrefix:"incremental-value.calculation-modal"}),[x,v]=(0,s.OT)();(0,o.KF)({shouldBeHidden:x});let{statistics:_,loading:f}=(0,d.Z)(),C=(0,r.useMemo)(()=>{if(!_)return;let{volume:e}=_;return{low:(0,s.rl)((null==e?void 0:e.low)||0),control:(0,s.rl)((null==e?void 0:e.control)||0)}},[_]),j=null==C?void 0:C.low,b=null==C?void 0:C.control;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u,{"data-ph":y,"data-auto-class":y,onClick:v.open,disabled:n,children:[t("cta","See how we calculate Incremental value from repeat revenue"),(0,a.jsx)(i.Z,{})]}),(0,a.jsx)(s.u_,{isOpen:x,onClose:v.close,modalVariant:"drawer-right",scrollBehaviour:"inside",children:(0,a.jsxs)(s.u_.Content,{children:[(0,a.jsxs)(s.u_.Header,{children:[(0,a.jsx)(s.H5,{children:t("title","How Incremental revenue is calculated")}),(0,a.jsx)(s.u_.CloseButton,{})]}),(0,a.jsxs)(s.u_.Body,{children:[(0,a.jsx)(l.cC,{t:t,i18nKey:"incremental-revenue.copy",children:(0,a.jsxs)(s.al,{children:[(0,a.jsx)(s.H4,{children:"How Incremental revenue is calculated?"}),(0,a.jsx)(s.M,{children:"In simple terms, Incremental revenue is the Repeat revenue you gained from showing customers with a Low Propensity to Refer an alternative action (which made them make another purchase) while also taking into account the revenue you might have gained if you had shown all your customers referral instead."}),(0,a.jsx)("img",{src:p,alt:"How incremental revenue is calculated"}),(0,a.jsx)(s.M,{children:"We directly compare the performance of the Low Propensity to Refer group (who are shown the alternative action) to that of the Control group (a group of customers also identified as having a low propensity to refer but who are shown referral instead, like the High Propensity to Refer group)."}),(0,a.jsx)(c.Z,{isLoading:f||!_,data:null==_?void 0:_.volume,chart:!f&&(null==_?void 0:_.volume)?(0,a.jsx)(m.Z,{data:null==_?void 0:_.volume}):(0,a.jsx)(m.Z.Skeleton,{}),heading:t("segmentation-split.title","Segmentation split"),description:(0,a.jsx)(l.cC,{t:t,i18nKey:"segmentation-split.description",children:(0,a.jsx)(s.al,{children:(0,a.jsxs)(s.M,{children:["Our Propensity to Refer model has correctly identified"," ",{unlikelyToReferPercentage:j}," of your customer base as unlikely to Refer. While ",{controlGroupPercentage:b}," of your customers also identified as unlikely to refer have been placed in the High PTR segment. This is to serve as a control group to accurately measure the incremental performance of customers in the Low PTR segment."]})})})}),(0,a.jsx)(s.M,{children:"We calculate the Repeat revenue by looking at the Low Propensity to Refer group’s performance (how much revenue is generated by encouraging users to repeat purchase)."}),(0,a.jsx)(s.M,{children:"While the Control group allows us to judge how much Referral revenue you may have missed out on by not showing all of your customers referral."}),(0,a.jsx)("img",{src:h,alt:"How incremental revenue is calculated, including annotations to show which group of customers the revenue came from (low PTR vs control group"})]})}),(0,a.jsx)("hr",{}),(0,a.jsx)(l.cC,{t:t,i18nKey:"repeat-revenue.copy",children:(0,a.jsxs)(s.al,{children:[(0,a.jsx)(s.H4,{children:"How is Repeat revenue calculated?"}),(0,a.jsx)(s.M,{children:'Previous tests have shown we can increase repeat rate by a relative 20% with an Discount off next purchase offer (eg from 10% to 12%), that extra "incremental" 2% is because of our offer. If it is ordered with their AOV, then that helps obtain the amount we can drive in the year.'}),(0,a.jsx)(s.M,{children:"We are conservative on this 20% in 2 ways."}),(0,a.jsx)(s.M,{children:(0,a.jsxs)("ol",{children:[(0,a.jsx)("li",{children:"We consider the 1st order repeat rate which is typically the lowest"}),(0,a.jsx)("li",{children:"We look at a 30 day repeat window as opposed to longer"})]})}),(0,a.jsx)(s.M,{children:"This ensures the incremental (eg. 2%) is conservative."}),(0,a.jsx)(s.M,{children:"Then we estimate the number of orders who will see the alternative offer if this is the value of the calculated value per alternative offer. We obtain the total amount of repeat revenue likely driven and take away the value of the lost referral opportunity from this low PTR group to find the Incremental revenue."}),(0,a.jsx)("img",{src:g,alt:"How repeat revenue is calculated"})]})})]}),(0,a.jsx)(s.u_.Footer,{children:(0,a.jsx)(s.zx,{variant:"secondary",onClick:v.close,children:t("close-text","Close")})})]})})]})},v=x;x.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueCalculationModal",props:{isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}}},"./src/client/reporting/utilities/inferGroupByFromTimePeriod.ts":function(e,n,t){t.d(n,{Z:()=>l});var a=t("./src/shared/@types/reporting.ts"),r=t("../node_modules/moment/moment.js"),i=t.n(r);let s=(e,n)=>{let t=i()(e,"X",!0),r=i()(n,"X",!0);if(!t.isValid()||!r.isValid())return a.Cc.DAY;let s=r.diff(t,"day");switch(!0){case s>182:return a.Cc.MONTH;case s>62:return a.Cc.WEEK;default:return a.Cc.DAY}},l=(e,n,t)=>{if(e===a.Iq.CUSTOM&&n&&t)return s(n,t);switch(e){case a.Iq.LAST_ALL_TIME:case a.Iq.LAST_12_MONTHS:case a.Iq.LAST_6_MONTHS:case a.Iq.LAST_3_MONTHS:case a.Iq.LAST_12_WHOLE_MONTHS:case a.Iq.LAST_6_WHOLE_MONTHS:case a.Iq.LAST_3_WHOLE_MONTHS:return a.Cc.MONTH;case a.Iq.LAST_60_DAYS:return a.Cc.WEEK;case a.Iq.LAST_30_DAYS:case a.Iq.LAST_7_DAYS:default:return a.Cc.DAY}}},"./src/shared/components/Charts/LineChart/index.ts":function(e,n,t){t.d(n,{Z:function(){return a.Z}});var a=t("./src/shared/components/Charts/LineChart/LineChart.tsx");t("./src/shared/components/Charts/LineChart/hooks/useLineChartConfig/useLineChartConfig.tsx")},"./src/shared/components/StatusLabel/StatusLabel.tsx":function(e,n,t){t.d(n,{i:()=>r,Z:()=>m});var a,r,i=t("../node_modules/react/jsx-runtime.js"),s=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),l=t("../node_modules/react-i18next/dist/es/index.js"),o=t("./src/shared/constants/filterStatuses.ts");let d=e=>{switch(e.toUpperCase()){case o.Z.LIVE:case o.Z.CURRENTLY_LIVE:case o.Z.RUNNING:return{variant:"status",status:"positive"};case o.Z.QUEUEING:case o.Z.READY:case o.Z.DRAFT:return{variant:"status",status:"neutral"};default:return{variant:"flair",backgroundColour:"Navy20",fontColour:"NavyBase"}}};(a=r||(r={})).CAMPAIGN="campaign",a.EXPERIMENT="experiment";let c=e=>{let{status:n,type:t,className:a,...r}=e,{t:o}=(0,l.$G)(["campaign","experiment"]);return(0,i.jsx)(s.__,{className:a,...d(n),...r,children:o(`${t}:status.${n}`)})};c.Skeleton=()=>(0,i.jsx)(s.Od,{width:37,height:14});let m=c;c.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"StatusLabel",props:{status:{required:!0,tsType:{name:"FilterStatuses"},description:""},type:{required:!0,tsType:{name:"StatusType"},description:""}}}},"./src/shared/components/StatusLabel/index.ts":function(e,n,t){t.d(n,{Z:function(){return r},i:function(){return a.i}});var a=t("./src/shared/components/StatusLabel/StatusLabel.tsx");let r=a.Z},"./src/shared/hooks/useMetricValuesOverTime/graphql/fetchMetricValuesOverTime.generated.ts":function(e,n,t){t.d(n,{v:function(){return a}});let a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchMetricValuesOverTime"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"merchantId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"metrics"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MetricEnum"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportParameters"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReportParametersInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"report_valuesOverTime"},arguments:[{kind:"Argument",name:{kind:"Name",value:"merchantId"},value:{kind:"Variable",name:{kind:"Name",value:"merchantId"}}},{kind:"Argument",name:{kind:"Name",value:"metrics"},value:{kind:"Variable",name:{kind:"Name",value:"metrics"}}},{kind:"Argument",name:{kind:"Name",value:"reportParameters"},value:{kind:"Variable",name:{kind:"Name",value:"reportParameters"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"drillDownUrl"}},{kind:"Field",name:{kind:"Name",value:"currencySymbol"}}]}},{kind:"Field",name:{kind:"Name",value:"series"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"isComparison"}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"metric"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"}},{kind:"Field",name:{kind:"Name",value:"y"}}]}}]}}]}}]}}]}},"./src/shared/hooks/useMetricValuesOverTime/useMetricValuesOverTime.ts":function(e,n,t){t.d(n,{Z:function(){return c}});var a=t("../node_modules/react/index.js"),r=t("../node_modules/@apollo/client/react/hooks/useQuery.js"),i=t("./src/shared/@types/reporting.ts"),s=t("./src/shared/hooks/index.ts"),l=t("./src/shared/hooks/useMetricValuesOverTime/graphql/fetchMetricValuesOverTime.generated.ts");let o=[i.Iq.LAST_WEEK,i.Iq.LAST_8_WEEKS,i.Iq.LAST_12_WEEKS,i.Iq.LAST_26_WEEKS,i.Iq.LAST_ALL_TIME,i.Iq.CUSTOM],d=[i.Iq.LAST_MONTH,i.Iq.LAST_3_WHOLE_MONTHS,i.Iq.SPECIFIC_3_MONTHS,i.Iq.LAST_6_WHOLE_MONTHS,i.Iq.SPECIFIC_6_MONTHS,i.Iq.LAST_12_WHOLE_MONTHS,i.Iq.SPECIFIC_13_MONTHS,i.Iq.SPECIFIC_24_MONTHS,i.Iq.LAST_ALL_TIME,i.Iq.CUSTOM],c=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{merchantId:m}=(0,s.rc)(),{loading:u,data:p,error:h}=(0,r.aM)(l.v,{variables:{merchantId:m,metrics:e,reportParameters:n},skip:c});return(0,a.useMemo)(()=>{let a=(null==p?void 0:p.report_valuesOverTime.series)||[],{groupBy:r,timePeriod:s}=n,l=r===i.Cc.WEEK&&!o.includes(s)||r===i.Cc.MONTH&&!d.includes(s);return{isLoading:u,isError:!!h,series:[...a].sort((n,t)=>{var a,r;let i=e.indexOf(null===(a=n.metadata)||void 0===a?void 0:a.metric),s=e.indexOf(null===(r=t.metadata)||void 0===r?void 0:r.metric);return i!==s?i-s:Number(n.isComparison)-Number(t.isComparison)}).map((e,n)=>{var a,r,i;let s=[...e.data],o=s[s.length-1],d=l&&0===o.y?s.slice(0,-1):s;return{id:e.id.replace(/\s+/g,"-"),metric:null===(a=e.metadata)||void 0===a?void 0:a.metric,name:t[n]??(null===(r=e.metadata)||void 0===r?void 0:r.name)??"",description:(null===(i=e.metadata)||void 0===i?void 0:i.description)??"",type:e.type,isComparison:e.isComparison,data:d}})}},[null==p?void 0:p.report_valuesOverTime.series,n,u,h,t,e])}},"../node_modules/@heroicons/react/20/solid/esm/ArrowUpCircleIcon.js":function(e,n,t){t.d(n,{Z:function(){return r}});var a=t("../node_modules/react/index.js");let r=a.forwardRef(function({title:e,titleId:n,...t},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":n},t),e?a.createElement("title",{id:n},e):null,a.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm-.75-4.75a.75.75 0 0 0 1.5 0V8.66l1.95 2.1a.75.75 0 1 0 1.1-1.02l-3.25-3.5a.75.75 0 0 0-1.1 0L6.2 9.74a.75.75 0 1 0 1.1 1.02l1.95-2.1v4.59Z",clipRule:"evenodd"}))})},"../node_modules/date-fns/formatRFC3339.mjs":function(e,n,t){t.d(n,{e:function(){return s}});var a=t("../node_modules/date-fns/isValid.mjs"),r=t("../node_modules/date-fns/toDate.mjs"),i=t("../node_modules/date-fns/_lib/addLeadingZeros.mjs");function s(e,n){let t=(0,r.Q)(e);if(!(0,a.J)(t))throw RangeError("Invalid time value");let s=n?.fractionDigits??0,l=(0,i.r)(t.getDate(),2),o=(0,i.r)(t.getMonth()+1,2),d=t.getFullYear(),c=(0,i.r)(t.getHours(),2),m=(0,i.r)(t.getMinutes(),2),u=(0,i.r)(t.getSeconds(),2),p="";if(s>0){let e=Math.trunc(t.getMilliseconds()*Math.pow(10,s-3));p="."+(0,i.r)(e,s)}let h="",g=t.getTimezoneOffset();if(0!==g){let e=Math.abs(g),n=(0,i.r)(Math.trunc(e/60),2),t=(0,i.r)(e%60,2);h=`${g<0?"+":"-"}${n}:${t}`}else h="Z";return`${d}-${o}-${l}T${c}:${m}:${u}${p}${h}`}}}]);