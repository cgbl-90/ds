"use strict";(globalThis.webpackChunk_mention_me_frontend=globalThis.webpackChunk_mention_me_frontend||[]).push([["9268"],{"./src/client/reporting/nps/NPSPage.stories.tsx":function(e,n,t){t.r(n),t.d(n,{default:()=>e6,NoRunningCampaignLessThanTwoWeeks:()=>e8,HappyPath:()=>e9,Upsell:()=>ne,NoRunningCampaignMoreThanTwoWeeks:()=>e7});var r=t("../node_modules/react/jsx-runtime.js"),s=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),a=t("../node_modules/msw/lib/core/graphql.mjs"),i=t("../node_modules/msw/lib/core/HttpResponse.mjs"),o=t("../node_modules/msw/lib/core/http.mjs"),l=t("../node_modules/styled-components/dist/styled-components.browser.esm.js"),d=t("./.storybook/preview.tsx"),p=t("./src/shared/context/EnvironmentContext.tsx"),c=t("./src/shared/context/NotificationContext.tsx"),m=t("./src/shared/context/posthog/CustomPostHogProvider.tsx"),u=t("./src/shared/styles/theme.ts"),h=t("./src/client/reporting/hooks/ReportingContext.tsx"),g=t("./src/client/reporting/nps/__mocks__/index.ts"),S=t("./src/client/reporting/nps/__mocks__/fetchNpsMetrics.msw.ts"),y=t("./src/client/reporting/nps/__mocks__/fetchRecentNPSFeedbackMock.ts"),N=t("./src/client/reporting/nps/__mocks__/NPSCampaignMock.mock.ts"),v=t("./src/client/reporting/nps/__mocks__/npsScores.ts"),P=t("./src/client/reporting/nps/__mocks__/TravelAndHospitality.ts"),f=t("../node_modules/react/index.js"),b=t("../node_modules/@apollo/client/react/hooks/useQuery.js"),x=t("../node_modules/react-i18next/dist/es/index.js"),k=t("./src/shared/components/Charts/SunburstChart/index.ts"),R=t("./src/shared/hooks/index.ts"),j=t("./src/shared/hooks/usePostHog/index.ts"),w=t("./src/client/reporting/nps/graphql/fetchNpsMetrics.generated.ts"),_=t("./src/client/reporting/nps/graphql/fetchRecentNPSFeedback.generated.ts"),C=t("./src/client/reporting/nps/hooks/useMerchantNpsState.ts"),T=t("./src/client/reporting/nps/styles.tsx"),M=t("../node_modules/@nivo/bar/dist/nivo-bar.es.js"),q=t("./src/shared/@types/reporting.ts"),A=t("./src/shared/components/Charts/index.ts"),E=t("./src/shared/components/Charts/ComparisonBarChart/index.ts"),Z=t("./src/client/reporting/nps/hooks/useNPSChartColourMap.ts");let H=()=>{let{t:e}=(0,x.$G)("reporting");return[{value:q.Iq.LAST_MONTH,label:e("periods.last-month-short","1 month")},{value:q.Iq.LAST_3_MONTHS,label:e("periods.last-3-months-short","3 months")},{value:q.Iq.LAST_6_MONTHS,label:e("periods.last-6-months-short","6 months")},{value:q.Iq.LAST_12_MONTHS,label:e("periods.last-12-months-short","12 months")},{value:q.Iq.LAST_ALL_TIME,label:e("periods.last-all-time-short","All time")}]},L=l.ZP.div.withConfig({displayName:"NPSBreakdownChart.styled__ContainerHeader"})(["display:flex;flex-wrap:wrap;gap:",";justify-content:space-between;margin-top:",";margin-bottom:",";"],(0,s.W0)(1),(0,s.W0)(4),(0,s.W0)(2)),D=()=>{let{t:e}=(0,x.$G)("reporting"),n=(0,Z.i)(),t=(0,A.$z)(),[a,i]=(0,f.useState)(q.Iq.LAST_3_MONTHS),{merchantId:o}=(0,R.rc)(),{campaignId:l}=(0,h.eh)(),d=(0,f.useMemo)(()=>({format:q.s6.FORMAT_JSON,timeperiod:a,merchantid:o,campaignid:l,reporttypelist:"MetricNPSAnswerZero,MetricNPSAnswerOne,MetricNPSAnswerTwo,MetricNPSAnswerThree,MetricNPSAnswerFour,MetricNPSAnswerFive,MetricNPSAnswerSix,MetricNPSAnswerSeven,MetricNPSAnswerEight,MetricNPSAnswerNine,MetricNPSAnswerTen",groupby:q.Cc.DAY}),[o,l,a]),{data:p,isLoading:c}=(0,R.kv)({route:"metric-compare-totals-nps",routeParams:d}),m=(0,f.useMemo)(()=>{if(c)return 0;let e=0;for(let t=0;t<11;t++){var n;e+=parseInt(String((null==p?void 0:null===(n=p.totals)||void 0===n?void 0:n[`_${t}`])||0),10)}return e},[p,c]),u=(0,f.useMemo)(()=>c?[]:Array.from(Array(11).keys()).map(e=>{var n;let t=parseInt(String((null==p?void 0:null===(n=p.totals)||void 0===n?void 0:n[`_${e}`])||0),10);return{score:e,total:t,percentage:m>0?Math.round(t/m*100):0}}),[p,m,c]),g=H(),S=e=>!e||e<7?"nps-detractors":e<9?"nps-passives":"nps-promoters";return(0,r.jsxs)(T.W2,{children:[(0,r.jsxs)(L,{children:[(0,r.jsx)(s.H3,{children:e("nps.score-distribution.title","NPS score distribution")}),(0,r.jsx)(s.Ee,{alignment:"start",orientation:"row",variant:"chip",state:{onChange:e=>i(e),value:a,isDisabled:!1,isUsingLabel:!0,options:g,name:"referral-value-date-selection"}})]}),(0,r.jsxs)(s.Zb,{children:[(0,r.jsx)(T.oP,{children:e("nps.chart.breakdown.title","Breakdown of scores by percentage")}),(0,r.jsx)(A.hC,{style:{height:"320px"},children:c?(0,r.jsx)(E.Z.Skeleton,{height:320}):(0,r.jsx)(M.jM,{data:u,theme:t,keys:["percentage"],indexBy:"score",margin:{top:50,right:8,bottom:50,left:50},valueScale:{type:"linear"},indexScale:{type:"band",round:!0},gridYValues:5,padding:.5,colors:e=>{let{data:{score:t}}=e;return n[S(t)]},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,tickValues:5,format:e=>`${e}%`},axisRight:null,axisBottom:{},enableLabel:!1,ariaLabel:e("nps.chart.breakdown.label","Score breakdown"),tooltip:t=>{let{data:{total:a,score:i}}=t,o=m>0?a/m*100:0;return(0,r.jsx)(A.h7,{headers:[e("nps.chart.breakdown.tooltip.header",{defaultValue:"Number of responses giving a score of {{score}}",score:i||0})],lines:[[{key:e(`nps.chart.breakdown.tooltip.${S(i)}`,"Promoters"),value:`${(0,s.uf)(o,{fixedFractionDigits:1})}% (${(0,s.uf)(a)} of ${(0,s.uf)(m)})`,color:n[S(i)]}]]})}})}),(0,r.jsx)(A.Qk,{legends:[e("nps.chart.breakdown.tooltip.nps-detractors","Detractors"),e("nps.chart.breakdown.tooltip.nps-passives","Passives"),e("nps.chart.breakdown.tooltip.nps-promoters","Promoters")],colours:[n[S(0)],n[S(7)],n[S(10)]]})]})]})};D.__docgenInfo={description:"",methods:[],displayName:"NPSBreakdownChart"};var O=t("./src/client/reporting/nps/components/NPSInsightSummary.tsx");let I=l.ZP.div.withConfig({displayName:"NPSPageContent.styled__NoRunningCampaignBanner"})(["margin-bottom:",";"],(0,s.W0)(4)),F=(0,l.ZP)("div").withConfig((0,s.NZ)("isUpsell")).withConfig({displayName:"NPSPageContent.styled__UpsellWrapper"})(["",";"],e=>{let{isUpsell:n}=e;return n&&(0,l.iv)(["position:relative;height:1000px;overflow:hidden;margin-bottom:",";"],(0,s.W0)(3))});(0,l.ZP)(s.eg).withConfig({displayName:"NPSPageContent.styled__InformationBox"})(["position:absolute;bottom:0;z-index:1;"]);let B=l.ZP.div.withConfig({displayName:"NPSPageContent.styled__Mask"})(["position:absolute;width:100%;height:100%;z-index:1;background:linear-gradient( 0deg,rgba(249,249,254,95%) 0%,rgba(249,249,254,60%) 63.54%,rgba(249,249,254,0%) 100% );"]);(0,l.ZP)(s.BY).attrs({as:"button"}).withConfig({displayName:"NPSPageContent.styled__ButtonLink"})(["font-size:inherit;&:hover,&:focus{color:",";}"],(0,s.Ys)("White"));var W=t("./src/client/reporting/nps/components/NPSScore.tsx"),V=t("./src/shared/components/index.ts"),$=t("./src/shared/hooks/useMerchantParams/useMerchantParams.ts");let G={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchMerchantForBenchmarking"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"merchantId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"merchant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"merchantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"category"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"heuristicCount"}}]}},{kind:"Field",name:{kind:"Name",value:"comparableSubCategories"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"heuristicCount"}}]}},{kind:"Field",name:{kind:"Name",value:"canCompareToCategory"}},{kind:"Field",name:{kind:"Name",value:"officialStartDate"}}]}}]}}]},U=()=>{var e,n,t,r;let{merchantId:s}=(0,$.Z)(),{data:a,loading:i}=(0,b.aM)(G,{variables:{merchantId:s}});return{category:null==a?void 0:null===(e=a.merchant)||void 0===e?void 0:e.category,subCategories:null==a?void 0:null===(n=a.merchant)||void 0===n?void 0:n.comparableSubCategories,canCompareToCategory:null==a?void 0:null===(t=a.merchant)||void 0===t?void 0:t.canCompareToCategory,officialStartDate:null==a?void 0:null===(r=a.merchant)||void 0===r?void 0:r.officialStartDate,loading:i}};var Y=t("./src/client/reporting/utilities/isYoungMerchant.ts"),z=t("./src/client/reporting/nps/hooks/useNPSData.ts"),K=t("./src/client/reporting/nps/components/NPSChart.tsx");let Q=l.ZP.div.withConfig({displayName:"NPSDistributionChart.styled__Container"})(["margin-top:",";"],(0,s.W0)(2)),X=()=>{let{t:e}=(0,x.$G)("reporting"),{chartData:n,isLoading:t}=(0,z.Z)();return(0,r.jsx)(Q,{children:(0,r.jsxs)(s.Zb,{children:[(0,r.jsx)(T.oP,{children:e("nps.distribution-chart.title","Distribution of NPS Sentiment")}),(0,r.jsxs)(s.S,{children:[" ",e("nps.distribution-chart.description","Responses split by their NPS category split over time")]}),(0,r.jsx)(A.hC,{style:{height:"320px"},children:t?(0,r.jsx)(E.Z.Skeleton,{height:320}):(0,r.jsx)(K.Z,{chartData:n})})]})})};X.__docgenInfo={description:"",methods:[],displayName:"NPSDistributionChart"};let J=l.ZP.div.withConfig({displayName:"NPSScoreByMonth.styled__ComparisonToggle"})(["display:flex;align-items:center;justify-content:space-between;gap:",";"],(0,s.W0)(1)),ee=l.ZP.div.withConfig({displayName:"NPSScoreByMonth.styled__ToggleSwitch"})(["padding-top:",";"],(0,s.W0)(.5)),en=l.ZP.div.withConfig({displayName:"NPSScoreByMonth.styled__ToggleContainer"})(["display:flex;align-items:center;justify-content:space-between;margin-left:auto;gap:",";"],(0,s.W0)(1)),et=(0,l.ZP)(s.H3).withConfig({displayName:"NPSScoreByMonth.styled__Header"})(["margin-bottom:",";"],(0,s.W0)(2)),er=e=>{let{score:n,previousScore:t,responses:a,previousResponses:i,shouldShowResponses:o,isComparedToPreviousYear:l,colours:d,lineColours:p,month:c,year:m}=e,{t:u}=(0,x.$G)("reporting"),h=[u("nps.chart.score-by-month.tooltip.header",{defaultValue:"NPS Score"})],g=[[{key:u("nps.chart.score-by-month.tooltip.score",{defaultValue:"{{month}} {{year}}",year:m,month:c}),value:String(n),color:d[1]??d[0]}]];if(o&&(h.push(u("nps.chart.score-by-month.tooltip.header-2",{defaultValue:"Number of responses"})),g.push([{key:u("nps.chart.score-by-month.tooltip.responses",{defaultValue:"{{month}} {{year}}",year:m,month:c}),value:(0,s.uf)(a),color:p[1]??p[0]}])),l){var S;g[0].push({key:u("nps.chart.score-by-month.tooltip.score",{defaultValue:"{{month}} {{year}}",year:m-1,month:c}),value:String(t),color:d[0]}),null===(S=g[1])||void 0===S||S.push({key:u("nps.chart.score-by-month.tooltip.responses",{defaultValue:"{{month}} {{year}}",year:m-1,month:c}),value:(0,s.uf)(i),color:p[0]})}return(0,r.jsx)(A.h7,{headers:h,lines:g})};er.__docgenInfo={description:"",methods:[],displayName:"NPSScoreByMonthTooltip",props:{score:{required:!0,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""},previousScore:{required:!0,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""},responses:{required:!0,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""},previousResponses:{required:!0,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""},isComparedToPreviousYear:{required:!0,tsType:{name:"boolean"},description:""},shouldShowResponses:{required:!0,tsType:{name:"boolean"},description:""},year:{required:!0,tsType:{name:"number"},description:""},month:{required:!0,tsType:{name:"string"},description:""},colours:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},lineColours:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""}}};let es=e=>{let{chartData:n,isComparedToPreviousYear:t,shouldShowResponses:a=!0}=e,{t:i}=(0,x.$G)("reporting"),{colors:o}=(0,l.Fg)(),d=(0,A.$z)(),p=(0,f.useMemo)(()=>Math.min(...n.map(e=>Number(e.score)||0),...n.map(e=>Number(e.previousScore)||0)),[n]),c=new Date().getFullYear(),m=(0,f.useMemo)(()=>t?["score","previousScore"]:["score"],[t]),u=(0,f.useMemo)(()=>a?[...t?["responses","previousResponses"]:["responses"]]:[],[t,a]),h=(0,f.useMemo)(()=>t?[o.PinkBase,o.NavyBase]:[o.PinkBase],[t,o.NavyBase,o.PinkBase]),g=(0,f.useMemo)(()=>a?[...t?[o.LightBlueBase,o.OrangeBase]:[o.LightBlueBase]]:[],[t,o.OrangeBase,o.LightBlueBase,a]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.hC,{style:{height:"320px"},children:(0,r.jsx)(A.Vq,{data:n,keys:m,indexBy:"month",colors:h,lineKeys:u,lineColors:g,theme:d,valueScale:{type:"linear",min:p-1,clamp:!0},indexScale:{type:"band",round:!0},padding:.4,gridYValues:5,axisLeft:{legend:i("nps.chart.score-by-month.legend","NPS Score"),legendPosition:"middle",legendOffset:-40,tickSize:5,tickPadding:5,tickRotation:0,tickValues:5},axisRight:{legend:i("nps.chart.score-by-month.legend-right","Responses"),legendPosition:"middle",legendOffset:50,tickSize:0,tickValues:5,format:e=>(0,s.uf)(e)},axisBottom:{tickRotation:-25,tickValues:n.length>5?"every 2":"every 1",format:e=>e.replace(/\s*\d+$/,"")},enableLabel:!1,tooltip:e=>(0,r.jsx)(er,{score:e.data.score,previousScore:e.data.previousScore,responses:e.data.responses,previousResponses:e.data.previousResponses,month:String(e.data.month).replace(/\d+$/,""),year:c,isComparedToPreviousYear:t,shouldShowResponses:a,colours:h,lineColours:g}),ariaLabel:i("nps.chart.score-by-month.label","NPS score by month")})}),(0,r.jsx)(A.Qk,{legends:[...m,...u].map(e=>i(`nps.chart.score-by-month.${e}`,{defaultValue:"NPS score {{year}}",year:e.startsWith("previous")?c-1:c})),colours:[...h,...g]})]})};es.Skeleton=()=>(0,r.jsx)(A.hC,{style:{height:"320px"},children:(0,r.jsx)(A.Vq.Skeleton,{})});es.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"NPSScoreByMonthChart",props:{chartData:{required:!0,tsType:{name:"Array",elements:[{name:"BarDatum"}],raw:"BarDatum[]"},description:""},isComparedToPreviousYear:{required:!0,tsType:{name:"boolean"},description:""},shouldShowResponses:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};let ea=()=>{let{t:e}=(0,x.$G)("reporting"),[n,t]=(0,f.useState)(!1),[a,i]=(0,f.useState)(!1),{postHog:o}=(0,j.U)(),{chartData:l,isLoading:d}=(0,z.Z)(q.MW.LAST_YEAR),{officialStartDate:p,loading:c}=U(),m=!c&&(!p||(0,Y.ZP)(p,13)),u=(0,f.useCallback)(()=>{t(e=>!e),null==o||o.capture("nps-score-by-month-comparison-toggle")},[o]),h=(0,f.useCallback)(()=>{i(e=>!e),null==o||o.capture("nps-score-by-month-responses-toggle")},[o]);return(0,r.jsxs)(T.W2,{children:[(0,r.jsx)(et,{children:e("nps.performance-over-time.title","NPS performance over time")}),(0,r.jsxs)(s.Zb,{variant:"slate",children:[(0,r.jsxs)(s.Zb,{children:[(0,r.jsxs)(T.oP,{children:[e("nps.score-by-month-chart.title","NPS score by month"),(0,r.jsxs)(en,{children:[(0,r.jsxs)(J,{children:[(0,r.jsx)(s.S,{children:e("nps.score-by-month-chart.responses-toggle","Show responses")}),(0,r.jsx)(ee,{children:(0,r.jsx)(V.Zh,{id:"shouldShowResponses",name:"shouldShowResponses",isChecked:a,onChange:h})})]}),!d&&!c&&!m&&l.length>0&&(0,r.jsxs)(J,{children:[(0,r.jsx)(s.S,{children:e("nps.score-by-month-chart.compare-toggle","Compare to previous year")}),(0,r.jsx)(ee,{children:(0,r.jsx)(V.Zh,{id:"compareToPreviousYear",name:"compareToPreviousYear",isChecked:n,onChange:u})})]})]})]}),d||c?(0,r.jsx)(es.Skeleton,{}):(0,r.jsx)(es,{chartData:l,isComparedToPreviousYear:n,shouldShowResponses:a})]}),(0,r.jsx)(X,{})]})]})};ea.__docgenInfo={description:"",methods:[],displayName:"NPSScoreByMonth"};var ei=t("../node_modules/lottie-react/build/index.umd.js"),eo=t.n(ei),el=t("./src/shared/assets/lottie/loading-spinner-1.json"),ed=t("./src/client/reporting/nps/context/NPSSentimentAnalysisContext.tsx");let ep=(0,l.ZP)(T.Wr).withConfig({displayName:"NPSSummaryTable.styled__Title"})(["margin-bottom:",";"],(0,s.W0)(.5)),ec=(0,l.ZP)(s.S).withConfig({displayName:"NPSSummaryTable.styled__Disclaimer"})(["display:block;"]),em=l.ZP.div.withConfig({displayName:"NPSSummaryTable.styled__TitleContainer"})(["margin-bottom:",";"],(0,s.W0)(2)),eu=l.ZP.div.withConfig({displayName:"NPSSummaryTable.styled__LoadingAnimation"})(["width:150px;height:150px;margin-left:auto;margin-right:auto;"]),eh=(0,l.ZP)(s.H4).withConfig({displayName:"NPSSummaryTable.styled__LoadingTitle"})(["text-align:center;"]),eg=(0,l.ZP)(s.XS).withConfig({displayName:"NPSSummaryTable.styled__LoadingBody"})(["text-align:center;"]),eS=(0,l.iv)(["display:grid;grid-template-columns:2fr 6fr 4fr 10fr;gap:",";align-items:flex-start;","{grid-template-columns:2fr 15fr 15fr 20fr;}"],(0,s.W0)(1),(0,s.mq)("lgMin","min")),ey=l.ZP.div.withConfig({displayName:"NPSSummaryTable.styled__Headers"})([""," padding:",";"],eS,(0,s.W0)(2)),eN=(0,l.ZP)(s.XS).withConfig({displayName:"NPSSummaryTable.styled__Header"})(["font-weight:",";text-transform:uppercase;&:first-child{grid-column-start:2;}"],(0,s.Ue)("h5"));var ev=t("./src/shared/hooks/useMedia/index.ts"),eP=t("./src/client/reporting/nps/components/NPSResponseCarousel.tsx");let ef=(0,l.F4)(["from{opacity:0;}to{opacity:1;}"]),eb=(0,l.ZP)(s.Zb).withConfig({displayName:"NPSSummaryTableRow.styled__Card"})(["margin-bottom:",";"],(0,s.W0)(2)),ex=l.ZP.div.withConfig({displayName:"NPSSummaryTableRow.styled__Details"})(["",""],eS),ek=(0,l.ZP)(e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",style:{enableBackground:"new 0 0 9 6"},viewBox:"0 0 9 6",...e,children:(0,r.jsx)("path",{d:"M9 .75C9 .68 8.96.6 8.91.54L8.46.09C8.4.04 8.32 0 8.25 0s-.15.04-.21.09L4.5 3.63.96.09A.358.358 0 0 0 .75 0C.67 0 .6.04.54.09L.09.54C.04.6 0 .68 0 .75S.04.9.09.96l4.2 4.2c.06.05.14.09.21.09.07 0 .15-.04.21-.09l4.2-4.2C8.96.9 9 .82 9 .75z"})})).withConfig((0,s.NZ)("isOpen")).withConfig({displayName:"NPSSummaryTableRow.styled__Icon"})(["fill:"," !important;",""],(0,s.Ys)("NavyBase"),e=>{let{isOpen:n}=e;return n&&(0,l.iv)(["transform:rotate(180deg);"])}),eR=(0,l.ZP)(s.S).withConfig({displayName:"NPSSummaryTableRow.styled__ProgressBarContainer"})(["display:flex;align-items:center;","{min-width:200px;margin-right:",";}"],(0,s.mq)("lgMin","min"),(0,s.W0)(5)),ej=(0,l.ZP)("div").withConfig((0,s.NZ)("width")).withConfig({displayName:"NPSSummaryTableRow.styled__ProgressBar"})(["display:inline-block;width:",";height:20px;margin-right:",";background-color:",";border-radius:10px;"],e=>{let{width:n}=e;return n},(0,s.W0)(1),(0,s.Ys)("BlueBase")),ew=l.ZP.ul.withConfig({displayName:"NPSSummaryTableRow.styled__AreasToExplore"})(["padding-left:",";"],(0,s.W0)(.5)),e_=l.ZP.hr.withConfig({displayName:"NPSSummaryTableRow.styled__HR"})(["margin:",";width:95%;height:2px;background-color:",";"],(0,s.W0)([1,0,1,0]),(0,s.Ys)("Grey80")),eC=l.ZP.div.withConfig({displayName:"NPSSummaryTableRow.styled__Related"})(["margin-left:",";"],(0,s.W0)(5)),eT=(0,l.ZP)(s.H5).withConfig({displayName:"NPSSummaryTableRow.styled__RelatedTitle"})(["margin:",";"],(0,s.W0)([2,0,2.5,5])),eM=l.ZP.div.withConfig({displayName:"NPSSummaryTableRow.styled__Animated"})(["animation:"," 300ms ease-in-out forwards;"],ef),eq=(0,l.ZP)(s.S).withConfig({displayName:"NPSSummaryTableRow.styled__Subject"})(["padding:0;background:none;border:none;outline:inherit;cursor:pointer;text-align:left;"]),eA=e=>{let{maxValue:n,subject:t,frequency:a,suggestions:i,related:o,isDefaultOpen:l}=e,{t:d}=(0,x.$G)("reporting"),p=a/n*100,[c,m]=(0,f.useState)(l||!1),u=(0,ev.Z)(["(max-width: 1100px)"],[!0],!1);return(0,r.jsxs)(eb,{children:[(0,r.jsxs)(ex,{children:[(0,r.jsx)(s.zx,{isIconOnly:!0,onClick:()=>{m(e=>!e)},variant:"link",size:"small","data-ph":"nps-customer-insight-card-toggle","data-auto-class":"summary-table-row-toggle",children:(0,r.jsx)(ek,{isOpen:c})}),(0,r.jsx)(eq,{as:"button",onClick:()=>m(e=>!e),"data-ph":"nps-customer-insight-card-subject",children:t}),(0,r.jsxs)(eR,{as:"div",children:[!u&&(0,r.jsx)(ej,{width:`${p}%`}),a]}),(0,r.jsx)(ew,{children:i.map(e=>(0,r.jsx)(s.S,{as:"li",children:e},e))})]}),c&&(0,r.jsxs)(eM,{children:[(0,r.jsx)(e_,{}),(0,r.jsx)(eT,{children:d("nps.summary.related","Key customers quotes")}),(0,r.jsx)(eC,{children:(0,r.jsx)(eP.k,{responses:o})})]})]},t)};eA.__docgenInfo={description:"",methods:[],displayName:"NPSSummaryTableRow",props:{maxValue:{required:!0,tsType:{name:"number"},description:""},subject:{required:!0,tsType:{name:"string"},description:""},frequency:{required:!0,tsType:{name:"number"},description:""},suggestions:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},related:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},isDefaultOpen:{required:!1,tsType:{name:"boolean"},description:""}}};var eE=t("./src/client/reporting/nps/components/SentimentAnalysisInformationBox/APIErrorInformationBox.tsx"),eZ=t("./src/client/reporting/nps/components/NPSNotification.tsx");let eH=()=>{let{t:e}=(0,x.$G)("reporting",{keyPrefix:"nps.not-enough-verbatim"}),{postHog:n}=(0,j.U)();return(0,f.useEffect)(()=>{null==n||n.capture("nps-sentiment-analysis-not-enough-verbatim")},[n]),(0,r.jsx)(eZ.Z,{title:e("title","We don’t have enough responses to show insights yet"),message:e("message","We need more text feedback to perform sentiment analysis. Please check later."),type:"info"})};eH.__docgenInfo={description:"",methods:[],displayName:"NotEnoughNPSVerbatimInformationBox"};let eL=()=>{let{t:e}=(0,x.$G)("reporting"),{postHog:n}=(0,j.U)(),{loading:t,tabularSummary:a,lastResponse:i,error:o,isError:l}=(0,ed.d)(),d=(0,f.useMemo)(()=>Math.max(...(a||[]).map(e=>e.frequency)),[a]),p=(0,f.useMemo)(()=>i?(0,s.p6)(i.createdDate,{notation:"custom",format:"dd-MMM-yy"}):null,[i]),c=(0,f.useMemo)(()=>{if("Not enough input data for ChatGPT"===o)return null==n||n.capture("nps-unhappy-not-enough-verbatim"),(0,r.jsx)(eH,{});return o&&(null==n||n.capture("nps-unhappy-generic-sentiment-error")),(0,r.jsx)(eE.Z,{})},[o,n]);return t?(0,r.jsx)(eL.Skeleton,{}):(0,r.jsxs)(T.W2,{children:[(0,r.jsxs)(em,{children:[(0,r.jsxs)(ep,{children:[e("nps.summary.title","Key customer insights")," ",(0,r.jsx)(V.WW,{message:e("nps.summary.tooltip","We perform analysis on messages that contain at least 3 words and are greater that 10 characters in length")})]}),p&&(0,r.jsx)(ec,{children:(0,r.jsxs)(x.cC,{t:e,i18nKey:"nps.summary.last-respond-date",children:["Based on the responses since ",(0,r.jsx)("strong",{children:{lastRespondDate:p}})]})})]}),l?c:(0,r.jsxs)(s.Zb,{variant:"slate",children:[(0,r.jsxs)(ey,{children:[(0,r.jsx)(eN,{children:e("nps.summary.table.header.subject","Theme")}),(0,r.jsx)(eN,{children:e("nps.summary.table.header.times-mentioned","Times Mentioned")}),(0,r.jsx)(eN,{children:e("nps.summary.table.header.areas-to-explore","Potential areas to Explore")})]}),null==a?void 0:a.map((e,n)=>(0,r.jsx)(eA,{isDefaultOpen:0===n,maxValue:d,...e},e.subject))]})]})};eL.Skeleton=()=>{let{t:e}=(0,x.$G)("reporting"),{currentLoadingFrame:n}=(0,ed.d)(),t=(0,f.useRef)(null);return(0,f.useEffect)(()=>{var e;null===(e=t.current)||void 0===e||e.goToAndStop(n,!0)},[n]),(0,r.jsx)(T.W2,{"aria-live":"assertive",children:(0,r.jsxs)(s.Zb,{children:[(0,r.jsx)(eh,{children:e("nps.summary.skeleton.title","Analysing sentiment")}),(0,r.jsx)(eu,{children:(0,r.jsx)(eo(),{animationData:el,"aria-labelledby":"summary-table-loading",lottieRef:t})}),(0,r.jsx)(eg,{id:"summary-table-loading",children:e("nps.summary.skeleton.body","This make take a few mins - feel free to leave this page")})]})})};eL.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"NPSSummaryTable"};var eD=t("./src/client/reporting/nps/components/NPSSummaryVerbatim/NPSSummaryVerbatim.tsx"),eO=t("./src/client/reporting/nps/components/SentimentAnalysisInformationBox/NoRunningCampaignInformationBox.tsx"),eI=t("./src/client/reporting/nps/components/SentimentAnalysisInformationBox/UpsellStateFloatingBox.tsx");let eF=()=>{var e;let{campaignId:n}=(0,h.eh)(),{isDemo:t,isLoading:a,isCurrentCampaignSuitableForNps:i,shouldUseMockData:o,hasNoCampaigns:l,hasNoRunningCampaigns:d,lastRunningCampaign:p}=(0,C.Z)(n),{t:c}=(0,x.$G)("reporting"),{postHog:m}=(0,j.U)(),{merchantId:u}=(0,R.rc)(),{data:g,loading:y}=(0,b.aM)(w.X,{variables:{merchantId:u},skip:!i}),{data:N,loading:v}=(0,b.aM)(_.K,{variables:{merchantId:u,limit:1},skip:t}),P=(0,f.useMemo)(()=>o?S.q.npsMetrics:null==g?void 0:g.npsMetrics,[o,g]);(0,f.useEffect)(()=>{l&&(null==m||m.capture("nps-unhappy-no-campaigns"))},[l,m]),(0,f.useEffect)(()=>{d&&p&&(null==m||m.capture("nps-unhappy-no-running-campaigns"))},[d,p,m]);let M=o&&!t;return(0,f.useEffect)(()=>{M&&(null==m||m.capture("nps-adopt-state"))},[M,m]),(0,r.jsxs)(r.Fragment,{children:[!o&&!v&&!l&&d&&!!(null==N?void 0:null===(e=N.nps)||void 0===e?void 0:e.edges.length)&&(0,r.jsx)(I,{children:(0,r.jsx)(eO.Z,{lastNPSFeedbackDate:N.nps.edges[0].createdDate})}),a?(0,r.jsx)(eF.Skeleton,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.Z,{}),(0,r.jsxs)(F,{isUpsell:M,children:[M&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B,{}),(0,r.jsx)(eI.Z,{})]}),(0,r.jsxs)(T.Xg,{children:[(0,r.jsx)(T.W2,{shouldHideOnMobile:M,children:(0,r.jsx)(k.Z,{initialState:{isLoadingMetrics:a,metrics:P},children:y?(0,r.jsx)(W.Z.Skeleton,{}):(0,r.jsx)(W.Z,{})})}),(0,r.jsxs)(T.W2,{children:[(0,r.jsx)(eL,{}),(0,r.jsx)(eD.Z,{}),(0,r.jsx)(ea,{}),(0,r.jsx)(D,{})]})]})]})]}),(0,r.jsx)(s.S,{children:c("nps.copyright","Net Promoter, Net Promoter System, Net Promoter Score, NPS and the NPS-related emoticons are registered trademarks of Bain & Company, Inc., Fred Reichheld and Satmetrix Systems, Inc.")})]})};eF.Skeleton=()=>(0,r.jsxs)(T.Xg,{children:[(0,r.jsx)(T.W2,{children:(0,r.jsx)(s.Od,{height:600,width:"100%"})}),(0,r.jsxs)(T.W2,{children:[(0,r.jsx)(s.Od,{height:300,width:"100%"}),(0,r.jsx)(s.Od,{height:300,width:"100%"})]})]});eF.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"NPSPageContent"};var eB=t("./src/client/reporting/nps/context/NPSContext.tsx"),eW=t("./src/shared/components/AIPoweredLabel/index.ts"),eV=t("./src/client/advocacy/components/AdvocacyTemplate.tsx"),e$=t("./src/client/reporting/hooks/useFilterableCampaigns.ts");let eG=e=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:[(0,r.jsx)("path",{fill:"currentColor",d:"M8.6 2.2a.6.6 0 0 0-1.2 0v6.89L5.036 6.588a.6.6 0 1 0-.873.824l3.4 3.6a.6.6 0 0 0 .873 0l3.4-3.6a.6.6 0 0 0-.873-.824L8.6 9.09V2.2Z"}),(0,r.jsx)("path",{fill:"currentColor",d:"M2.8 10.2a.6.6 0 0 0-1.2 0v2a2.2 2.2 0 0 0 2.2 2.2h8.4a2.2 2.2 0 0 0 2.2-2.2v-2a.6.6 0 1 0-1.2 0v2a1 1 0 0 1-1 1H3.8a1 1 0 0 1-1-1v-2Z"})]});var eU=t("../node_modules/@apollo/client/react/hooks/useMutation.js"),eY=t("./src/user/hooks/useActiveUserState.ts");let ez={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"requestNPSDownload"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"merchantId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notifyUser"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timePeriod"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"reportType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"report_schedule"},arguments:[{kind:"Argument",name:{kind:"Name",value:"merchantId"},value:{kind:"Variable",name:{kind:"Name",value:"merchantId"}}},{kind:"Argument",name:{kind:"Name",value:"reportType"},value:{kind:"Variable",name:{kind:"Name",value:"reportType"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"StringValue",value:"csv",block:!1}},{kind:"Argument",name:{kind:"Name",value:"over"},value:{kind:"StringValue",value:"PERIOD",block:!1}},{kind:"Argument",name:{kind:"Name",value:"shouldNotify"},value:{kind:"Variable",name:{kind:"Name",value:"notifyUser"}}},{kind:"Argument",name:{kind:"Name",value:"timePeriod"},value:{kind:"Variable",name:{kind:"Name",value:"timePeriod"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},eK=()=>{let{t:e}=(0,x.$G)("reporting"),{addSuccessNotification:n,addErrorNotification:t}=(0,c.kE)(),{merchantId:r}=(0,R.rc)(),{data:s}=(0,eY.Z)(),a=null==s?void 0:s.email,[i]=(0,eU.D)(ez,{onError(){t(e("nps.feedback-download.notifications.error.title","Oops!"),e("nps.feedback-download.notifications.error.description","Sorry! We have experienced a problem with your request. Please try again later"))},onCompleted(){n(e("nps.feedback-download.notifications.success.title","We're preparing your file"),a?e("nps.feedback-download.notifications.success.with-email-description",{defaultValue:"Success! We'll email you the last 12 months report within 15 minutes at {{userEmail}} when it's ready for download.",userEmail:a}):e("nps.feedback-download.notifications.success.without-email-description",{defaultValue:"Success! We'll email you the last 12 months report within 15 minutes when it's ready for download."}))}});return(0,f.useCallback)(()=>{i({variables:{merchantId:r,notifyUser:!0,timePeriod:q.Iq.LAST_12_MONTHS,reportType:"npsfeedback"}})},[i,r])},eQ=e=>{let{campaignTypes:n}=e,{t}=(0,x.$G)("reporting"),a=eK(),{loading:i,campaigns:o}=(0,e$.Z)({campaignTypes:n});return(0,r.jsxs)(r.Fragment,{children:[i&&(0,r.jsx)(s.Od,{width:235,height:34}),!i&&o.length>0&&(0,r.jsxs)(s.zx,{"data-ph":"nps-download-customer-feedback",variant:"outline",onClick:()=>{a()},children:[(0,r.jsx)(eG,{})," ",t("ecr.feedback-download.cta","Download customer feedback")]})]})};eQ.__docgenInfo={description:"",methods:[],displayName:"NPSFeedbackDownloadButton",props:{campaignTypes:{required:!0,tsType:{name:"Array",elements:[{name:"union",raw:'"REFERRAL" | "IFA" | "NPS"',elements:[{name:"literal",value:'"REFERRAL"'},{name:"literal",value:'"IFA"'},{name:"literal",value:'"NPS"'}]}],raw:"CampaignType[]"},description:""}}};var eX=t("../node_modules/@heroicons/react/24/solid/esm/ArrowDownTrayIcon.js"),eJ=t("./src/shared/utilities/index.ts"),e0=t("./src/client/reporting/hooks/types.ts");let e1=e=>{let{campaignTypes:n}=e,{t}=(0,x.$G)("reporting"),{loading:a,campaigns:i}=(0,e$.Z)({campaignTypes:n}),{campaignId:o}=(0,h.eh)(),{merchantId:l}=(0,R.rc)(),{loading:d,isError:p}=(0,ed.d)(),c=(0,eJ.nu)("nps_sentiment_analysis_pdf",{merchantId:l,...o!==e0.TD.CampaignSelector&&{campaignId:o}});return(0,r.jsxs)(r.Fragment,{children:[(a||d)&&(0,r.jsx)(s.Od,{width:235,height:34}),!a&&!d&&!p&&i.length>0&&(0,r.jsxs)(s.zx,{as:"a","data-ph":"nps-generate-report",variant:"outline",href:c,children:[(0,r.jsx)(eX.Z,{})," ",t("generate-report-cta","Generate report")]})]})};e1.__docgenInfo={description:"",methods:[],displayName:"NPSGenerateReportButton",props:{campaignTypes:{required:!0,tsType:{name:"Array",elements:[{name:"union",raw:'"REFERRAL" | "IFA" | "NPS"',elements:[{name:"literal",value:'"REFERRAL"'},{name:"literal",value:'"IFA"'},{name:"literal",value:'"NPS"'}]}],raw:"CampaignType[]"},description:""}}};let e2=l.ZP.span.withConfig({displayName:"NPSPage.styled__Header"})(["display:flex;justify-content:space-between;align-items:center;"]),e5=["NPS"],e4=()=>{let{t:e}=(0,x.$G)("reporting");return(0,r.jsxs)(eV.Z,{title:(0,r.jsxs)(e2,{children:[e("nps.title","NPS Sentiment Analysis"),(0,r.jsx)(eW.Z,{variant:"dark"})]}),subtitle:e("nps.subtitle","Understand what customers really think of your brand to drive the most impactful change"),initialState:{timePeriod:q.Iq.LAST_12_WHOLE_MONTHS},children:[(0,r.jsxs)(eV.Z.Actions,{shouldShowCampaignFilter:!0,campaignTypes:e5,children:[(0,r.jsx)(eQ,{campaignTypes:e5}),(0,r.jsx)(ed.g,{children:(0,r.jsx)(e1,{campaignTypes:e5})})]}),(0,r.jsx)(ed.g,{children:(0,r.jsx)(eB.n,{children:(0,r.jsx)(eF,{})})})]})};e4.__docgenInfo={description:"",methods:[],displayName:"NPSPage"};let e6={component:e4,title:"Portal / Reporting / Sentiment Analysis / NPS",parameters:{chromatic:{disableSnapshot:!0}}},e3=e=>{let{hasNoRunningCampaigns:n,hasNoCampaigns:t,isLastMessageReceivedMoreThanTwoWeeksAgo:f}=e;return d.server.use(a.B.query("fetchFilterableCampaigns",()=>i.Z.json({data:(0,N.M)(n,t)}))),d.server.use(a.B.query("fetchNpsMetrics",()=>i.Z.json({data:S.q}))),d.server.use(a.B.query("fetchRecentNPSFeedback",()=>i.Z.json({data:(0,y.Zz)(f)}))),d.server.use(a.B.query("fetchSentimentSummary",()=>i.Z.json({data:P.Z}))),d.server.use(o.d.get("/metric-value",e=>{let{request:n}=e;switch(new URLSearchParams(new URL(n.url).search).get("reporttypelist")){case"MetricNPSPromoters":return i.Z.json(v.I7);case"MetricNPSPassives":return i.Z.json(v.bk);case"MetricNPSDetractors":return i.Z.json(v.Gx);case"MetricNPSResponses":return i.Z.json(v.Z7);case"NPSScore":return i.Z.json(v.FS);default:return i.Z.json(g.ze)}}),o.d.get("/metric-percent",()=>i.Z.json(v.X8))),(0,r.jsx)("div",{style:{width:"1200px"},children:(0,r.jsxs)(l.f6,{theme:u.Z,children:[(0,r.jsx)(s.ZL,{}),(0,r.jsx)(p.uX,{children:(0,r.jsx)(c.JB,{children:(0,r.jsx)(m.Z,{children:(0,r.jsx)(h.U,{children:(0,r.jsx)(ed.g,{children:(0,r.jsx)(eB.n,{children:(0,r.jsx)(eF,{})})})})})})})]})})},e9=e3.bind({});e9.args={hasNoRunningCampaigns:!1,hasNoCampaigns:!1};let e8=e3.bind({});e8.args={hasNoRunningCampaigns:!0,hasNoCampaigns:!1};let e7=e3.bind({});e7.args={hasNoRunningCampaigns:!0,hasNoCampaigns:!1,isLastMessageReceivedMoreThanTwoWeeksAgo:!0};let ne=e3.bind({});ne.args={hasNoRunningCampaigns:!1,hasNoCampaigns:!0},e9.parameters={...e9.parameters,docs:{...e9.parameters?.docs,source:{originalSource:'({\n  hasNoRunningCampaigns,\n  hasNoCampaigns,\n  isLastMessageReceivedMoreThanTwoWeeksAgo\n}) => {\n  server.use(graphql.query("fetchFilterableCampaigns", () => {\n    return HttpResponse.json({\n      data: generateCampaignMockData(hasNoRunningCampaigns, hasNoCampaigns)\n    });\n  }));\n  server.use(graphql.query("fetchNpsMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_DATA\n    });\n  }));\n  server.use(graphql.query("fetchRecentNPSFeedback", () => {\n    return HttpResponse.json({\n      data: generateRecentNPSFeedbackMockData(isLastMessageReceivedMoreThanTwoWeeksAgo)\n    });\n  }));\n  server.use(graphql.query("fetchSentimentSummary", () => {\n    return HttpResponse.json({\n      data: TRAVEL_AND_HOSPITALITY\n    });\n  }));\n  server.use(http.get("/metric-value", ({\n    request\n  }) => {\n    const url = new URL(request.url);\n    const metric = new URLSearchParams(url.search).get("reporttypelist");\n    switch (metric) {\n      case "MetricNPSPromoters":\n        return HttpResponse.json(NPS_PROMOTERS);\n      case "MetricNPSPassives":\n        return HttpResponse.json(NPS_PASSIVES);\n      case "MetricNPSDetractors":\n        return HttpResponse.json(NPS_DETRACTORS);\n      case "MetricNPSResponses":\n        return HttpResponse.json(NPS_RESPONSES);\n      case "NPSScore":\n        return HttpResponse.json(NPS_SCORE);\n      default:\n        return HttpResponse.json(MOCK_NPS_METRICS);\n    }\n  }), http.get("/metric-percent", () => {\n    return HttpResponse.json(NPS_RESPONSE_RATE);\n  }));\n  return <div style={{\n    width: "1200px"\n  }}>\n            <ThemeProvider theme={defaultTheme}>\n                <GlobalStyle />\n                <EnvironmentProvider>\n                    <NotificationProvider>\n                        <CustomPostHogProvider>\n                            <ReportingProvider>\n                                <NPSSentimentAnalysisProvider>\n                                    <NpsStateProvider>\n                                        <NPSPageContent />\n                                    </NpsStateProvider>\n                                </NPSSentimentAnalysisProvider>\n                            </ReportingProvider>\n                        </CustomPostHogProvider>\n                    </NotificationProvider>\n                </EnvironmentProvider>\n            </ThemeProvider>\n        </div>;\n}',...e9.parameters?.docs?.source}}},e8.parameters={...e8.parameters,docs:{...e8.parameters?.docs,source:{originalSource:'({\n  hasNoRunningCampaigns,\n  hasNoCampaigns,\n  isLastMessageReceivedMoreThanTwoWeeksAgo\n}) => {\n  server.use(graphql.query("fetchFilterableCampaigns", () => {\n    return HttpResponse.json({\n      data: generateCampaignMockData(hasNoRunningCampaigns, hasNoCampaigns)\n    });\n  }));\n  server.use(graphql.query("fetchNpsMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_DATA\n    });\n  }));\n  server.use(graphql.query("fetchRecentNPSFeedback", () => {\n    return HttpResponse.json({\n      data: generateRecentNPSFeedbackMockData(isLastMessageReceivedMoreThanTwoWeeksAgo)\n    });\n  }));\n  server.use(graphql.query("fetchSentimentSummary", () => {\n    return HttpResponse.json({\n      data: TRAVEL_AND_HOSPITALITY\n    });\n  }));\n  server.use(http.get("/metric-value", ({\n    request\n  }) => {\n    const url = new URL(request.url);\n    const metric = new URLSearchParams(url.search).get("reporttypelist");\n    switch (metric) {\n      case "MetricNPSPromoters":\n        return HttpResponse.json(NPS_PROMOTERS);\n      case "MetricNPSPassives":\n        return HttpResponse.json(NPS_PASSIVES);\n      case "MetricNPSDetractors":\n        return HttpResponse.json(NPS_DETRACTORS);\n      case "MetricNPSResponses":\n        return HttpResponse.json(NPS_RESPONSES);\n      case "NPSScore":\n        return HttpResponse.json(NPS_SCORE);\n      default:\n        return HttpResponse.json(MOCK_NPS_METRICS);\n    }\n  }), http.get("/metric-percent", () => {\n    return HttpResponse.json(NPS_RESPONSE_RATE);\n  }));\n  return <div style={{\n    width: "1200px"\n  }}>\n            <ThemeProvider theme={defaultTheme}>\n                <GlobalStyle />\n                <EnvironmentProvider>\n                    <NotificationProvider>\n                        <CustomPostHogProvider>\n                            <ReportingProvider>\n                                <NPSSentimentAnalysisProvider>\n                                    <NpsStateProvider>\n                                        <NPSPageContent />\n                                    </NpsStateProvider>\n                                </NPSSentimentAnalysisProvider>\n                            </ReportingProvider>\n                        </CustomPostHogProvider>\n                    </NotificationProvider>\n                </EnvironmentProvider>\n            </ThemeProvider>\n        </div>;\n}',...e8.parameters?.docs?.source}}},e7.parameters={...e7.parameters,docs:{...e7.parameters?.docs,source:{originalSource:'({\n  hasNoRunningCampaigns,\n  hasNoCampaigns,\n  isLastMessageReceivedMoreThanTwoWeeksAgo\n}) => {\n  server.use(graphql.query("fetchFilterableCampaigns", () => {\n    return HttpResponse.json({\n      data: generateCampaignMockData(hasNoRunningCampaigns, hasNoCampaigns)\n    });\n  }));\n  server.use(graphql.query("fetchNpsMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_DATA\n    });\n  }));\n  server.use(graphql.query("fetchRecentNPSFeedback", () => {\n    return HttpResponse.json({\n      data: generateRecentNPSFeedbackMockData(isLastMessageReceivedMoreThanTwoWeeksAgo)\n    });\n  }));\n  server.use(graphql.query("fetchSentimentSummary", () => {\n    return HttpResponse.json({\n      data: TRAVEL_AND_HOSPITALITY\n    });\n  }));\n  server.use(http.get("/metric-value", ({\n    request\n  }) => {\n    const url = new URL(request.url);\n    const metric = new URLSearchParams(url.search).get("reporttypelist");\n    switch (metric) {\n      case "MetricNPSPromoters":\n        return HttpResponse.json(NPS_PROMOTERS);\n      case "MetricNPSPassives":\n        return HttpResponse.json(NPS_PASSIVES);\n      case "MetricNPSDetractors":\n        return HttpResponse.json(NPS_DETRACTORS);\n      case "MetricNPSResponses":\n        return HttpResponse.json(NPS_RESPONSES);\n      case "NPSScore":\n        return HttpResponse.json(NPS_SCORE);\n      default:\n        return HttpResponse.json(MOCK_NPS_METRICS);\n    }\n  }), http.get("/metric-percent", () => {\n    return HttpResponse.json(NPS_RESPONSE_RATE);\n  }));\n  return <div style={{\n    width: "1200px"\n  }}>\n            <ThemeProvider theme={defaultTheme}>\n                <GlobalStyle />\n                <EnvironmentProvider>\n                    <NotificationProvider>\n                        <CustomPostHogProvider>\n                            <ReportingProvider>\n                                <NPSSentimentAnalysisProvider>\n                                    <NpsStateProvider>\n                                        <NPSPageContent />\n                                    </NpsStateProvider>\n                                </NPSSentimentAnalysisProvider>\n                            </ReportingProvider>\n                        </CustomPostHogProvider>\n                    </NotificationProvider>\n                </EnvironmentProvider>\n            </ThemeProvider>\n        </div>;\n}',...e7.parameters?.docs?.source}}},ne.parameters={...ne.parameters,docs:{...ne.parameters?.docs,source:{originalSource:'({\n  hasNoRunningCampaigns,\n  hasNoCampaigns,\n  isLastMessageReceivedMoreThanTwoWeeksAgo\n}) => {\n  server.use(graphql.query("fetchFilterableCampaigns", () => {\n    return HttpResponse.json({\n      data: generateCampaignMockData(hasNoRunningCampaigns, hasNoCampaigns)\n    });\n  }));\n  server.use(graphql.query("fetchNpsMetrics", () => {\n    return HttpResponse.json({\n      data: MOCK_DATA\n    });\n  }));\n  server.use(graphql.query("fetchRecentNPSFeedback", () => {\n    return HttpResponse.json({\n      data: generateRecentNPSFeedbackMockData(isLastMessageReceivedMoreThanTwoWeeksAgo)\n    });\n  }));\n  server.use(graphql.query("fetchSentimentSummary", () => {\n    return HttpResponse.json({\n      data: TRAVEL_AND_HOSPITALITY\n    });\n  }));\n  server.use(http.get("/metric-value", ({\n    request\n  }) => {\n    const url = new URL(request.url);\n    const metric = new URLSearchParams(url.search).get("reporttypelist");\n    switch (metric) {\n      case "MetricNPSPromoters":\n        return HttpResponse.json(NPS_PROMOTERS);\n      case "MetricNPSPassives":\n        return HttpResponse.json(NPS_PASSIVES);\n      case "MetricNPSDetractors":\n        return HttpResponse.json(NPS_DETRACTORS);\n      case "MetricNPSResponses":\n        return HttpResponse.json(NPS_RESPONSES);\n      case "NPSScore":\n        return HttpResponse.json(NPS_SCORE);\n      default:\n        return HttpResponse.json(MOCK_NPS_METRICS);\n    }\n  }), http.get("/metric-percent", () => {\n    return HttpResponse.json(NPS_RESPONSE_RATE);\n  }));\n  return <div style={{\n    width: "1200px"\n  }}>\n            <ThemeProvider theme={defaultTheme}>\n                <GlobalStyle />\n                <EnvironmentProvider>\n                    <NotificationProvider>\n                        <CustomPostHogProvider>\n                            <ReportingProvider>\n                                <NPSSentimentAnalysisProvider>\n                                    <NpsStateProvider>\n                                        <NPSPageContent />\n                                    </NpsStateProvider>\n                                </NPSSentimentAnalysisProvider>\n                            </ReportingProvider>\n                        </CustomPostHogProvider>\n                    </NotificationProvider>\n                </EnvironmentProvider>\n            </ThemeProvider>\n        </div>;\n}',...ne.parameters?.docs?.source}}}},"./src/client/reporting/nps/__mocks__/NPSCampaignMock.mock.ts":function(e,n,t){t.d(n,{M:function(){return r}});let r=(e,n)=>({merchant:{id:"1",campaigns:{edges:[{id:"12537",shortName:"RoW",hasEverRunReferral:!1,hasEverRunIFA:!1,hasEverRunNPS:!n,hasRunningNPSExperiments:!n,hasEverSupportedNativeShareWithMessageCapture:!1,dateLastLiveWithNPS:null,status:e?"ARCHIVED":"CURRENTLY_LIVE"}]}}})},"../node_modules/@heroicons/react/24/solid/esm/StarIcon.js":function(e,n,t){t.d(n,{Z:function(){return s}});var r=t("../node_modules/react/index.js");let s=r.forwardRef(function({title:e,titleId:n,...t},s){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},t),e?r.createElement("title",{id:n},e):null,r.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))})},"../node_modules/msw/lib/core/graphql.mjs":function(e,n,t){t.d(n,{B:()=>b});var r=t("../node_modules/msw/lib/core/handlers/RequestHandler.mjs"),s=t("../node_modules/msw/lib/core/utils/logging/getTimestamp.mjs"),a=t("../node_modules/msw/lib/core/utils/logging/getStatusCodeColor.mjs"),i=t("../node_modules/msw/lib/core/utils/logging/serializeRequest.mjs"),o=t("../node_modules/msw/lib/core/utils/logging/serializeResponse.mjs"),l=t("../node_modules/msw/lib/core/utils/matching/matchRequestUrl.mjs"),d=t("../node_modules/msw/lib/core/utils/request/toPublicUrl.mjs"),p=t("../node_modules/msw/lib/core/utils/internal/devUtils.mjs");function c(e){try{return JSON.parse(e)}catch{return}}var m=t("../node_modules/headers-polyfill/lib/index.mjs");function u(e){let n=e.definitions.find(e=>"OperationDefinition"===e.kind);return{operationType:n?.operation,operationName:n?.name?.value}}async function h(e){let{parse:n}=await t.e("8055").then(t.bind(t,"../node_modules/msw/node_modules/graphql/index.mjs")).catch(e=>{throw console.error('[MSW] Failed to parse a GraphQL query: cannot import the "graphql" module. Please make sure you install it if you wish to intercept GraphQL requests. See the original import error below.'),e});try{let t=n(e);return u(t)}catch(e){return e}}async function g(e){switch(e.method){case"GET":{let n=new URL(e.url),t=n.searchParams.get("query");return{query:t,variables:c(n.searchParams.get("variables")||"")}}case"POST":{let n=e.clone();if(e.headers.get("content-type")?.includes("multipart/form-data")){let t=function(e,n){let t=n?.get("content-type");if(!t)return;let[,...r]=t.split(/; */),s=r.filter(e=>e.startsWith("boundary=")).map(e=>e.replace(/^boundary=/,""))[0];if(!s)return;let a=RegExp(`--+${s}`),i=e.split(a).filter(e=>e.startsWith("\r\n")&&e.endsWith("\r\n")).map(e=>e.trimStart().replace(/\r\n$/,""));if(!i.length)return;let o={};try{for(let e of i){let[n,...t]=e.split("\r\n\r\n"),r=t.join("\r\n\r\n"),{contentType:s,filename:a,name:i}=function(e){let n=(0,m.$M)(e),t=n.get("content-type")||"text/plain",r=n.get("content-disposition");if(!r)throw Error('"Content-Disposition" header is required.');let s=r.split(";").reduce((e,n)=>{let[t,...r]=n.trim().split("=");return e[t]=r.join("="),e},{}),a=s.name?.slice(1,-1);return{name:a,filename:s.filename?.slice(1,-1),contentType:t}}(n),l=void 0===a?r:new File([r],a,{type:s}),d=o[i];void 0===d?o[i]=l:Array.isArray(d)?o[i]=[...d,l]:o[i]=[d,l]}return o}catch{return}}(await n.text(),e.headers);if(!t)return null;let{operations:r,map:s,...a}=t,i=c(r)||{};if(!i.query)return null;let o=c(s||"")||{},l=i.variables?function(e,n,t){let r={variables:e};for(let[e,s]of Object.entries(n)){if(!(e in t))throw Error(`Given files do not have a key '${e}' .`);for(let n of s){let[s,...a]=n.split(".").reverse(),i=a.reverse(),o=r;for(let e of i){if(!(e in o))throw Error(`Property '${i}' is not in operations.`);o=o[e]}o[s]=t[e]}}return r.variables}(i.variables,o,a):{};return{query:i.query,variables:l}}let t=await n.json().catch(()=>null);if(t?.query){let{query:e,variables:n}=t;return{query:e,variables:n}}}default:return null}}async function S(e){let n=await g(e);if(!n||!n.query)return;let{query:t,variables:r}=n,s=await h(t);if(s instanceof Error){let n=(0,d.F)(e.url);throw Error(p.e.formatMessage('Failed to intercept a GraphQL request to "%s %s": cannot parse query. See the error message from the parser below.\n\n%s',e.method,n,s.message))}return{query:n.query,operationType:s.operationType,operationName:s.operationName,variables:r}}var y=t("../node_modules/msw/lib/core/utils/request/getRequestCookies.mjs");class N extends r.Z{endpoint;static parsedRequestCache=new WeakMap;constructor(e,n,t,r,s){var a;let i=n;if(null!=(a=n)&&"object"==typeof a&&"kind"in a&&"definitions"in a){let t=u(n);if(t.operationType!==e)throw Error(`Failed to create a GraphQL handler: provided a DocumentNode with a mismatched operation type (expected "${e}", but got "${t.operationType}").`);if(!t.operationName)throw Error("Failed to create a GraphQL handler: provided a DocumentNode with no operation name.");i=t.operationName}super({info:{header:"all"===e?`${e} (origin: ${t.toString()})`:`${e} ${i} (origin: ${t.toString()})`,operationType:e,operationName:i},resolver:r,options:s}),this.endpoint=t}async parseGraphQLRequestOrGetFromCache(e){return!N.parsedRequestCache.has(e)&&N.parsedRequestCache.set(e,await S(e).catch(e=>{console.error(e)})),N.parsedRequestCache.get(e)}async parse(e){let n=(0,l.R)(new URL(e.request.url),this.endpoint),t=(0,y.B)(e.request);if(!n.matches)return{match:n,cookies:t};let r=await this.parseGraphQLRequestOrGetFromCache(e.request);return void 0===r?{match:n,cookies:t}:{match:n,cookies:t,query:r.query,operationType:r.operationType,operationName:r.operationName,variables:r.variables}}predicate(e){if(void 0===e.parsedResult.operationType)return!1;if(!e.parsedResult.operationName&&"all"!==this.info.operationType){let n=(0,d.F)(e.request.url);return p.e.warn(`Failed to intercept a GraphQL request at "${e.request.method} ${n}": anonymous GraphQL operations are not supported.

Consider naming this operation or using "graphql.operation()" request handler to intercept GraphQL requests regardless of their operation name/type. Read more: https://mswjs.io/docs/api/graphql/#graphqloperationresolver`),!1}let n="all"===this.info.operationType||e.parsedResult.operationType===this.info.operationType,t=this.info.operationName instanceof RegExp?this.info.operationName.test(e.parsedResult.operationName||""):e.parsedResult.operationName===this.info.operationName;return e.parsedResult.match.matches&&n&&t}extendResolverArgs(e){return{query:e.parsedResult.query||"",operationName:e.parsedResult.operationName||"",variables:e.parsedResult.variables||{},cookies:e.parsedResult.cookies}}async log(e){let n=await (0,i.Y)(e.request),t=await (0,o.X)(e.response),r=(0,a.m)(t.status),l=e.parsedResult.operationName?`${e.parsedResult.operationType} ${e.parsedResult.operationName}`:`anonymous ${e.parsedResult.operationType}`;console.groupCollapsed(p.e.formatMessage(`${(0,s.u)()} ${l} (%c${t.status} ${t.statusText}%c)`),`color:${r}`,"color:inherit"),console.log("Request:",n),console.log("Handler:",this),console.log("Response:",t),console.groupEnd()}}function v(e,n){return(t,r,s={})=>new N(e,t,n,r,s)}function P(e){return n=>new N("all",RegExp(".*"),e,n)}let f={query:v("query","*"),mutation:v("mutation","*"),operation:P("*")},b={...f,link:function(e){return{operation:P(e),query:v("query",e),mutation:v("mutation",e)}}}}}]);
//# sourceMappingURL=client-reporting-nps-NPSPage-stories.02bd635b.iframe.bundle.js.map