"use strict";(globalThis.webpackChunk_mention_me_frontend=globalThis.webpackChunk_mention_me_frontend||[]).push([["5458"],{"./src/client/customer/profile/components/CustomerProfileActivity/components/ActivityFeedItems/components/ActivityOfferDetails.tsx":function(e,i,n){n.d(i,{Z:function(){return s}});var r=n("../node_modules/react/jsx-runtime.js"),t=n("./src/shared/components/OfferLink/OfferLink.tsx");let a=e=>{var i;let{offer:n}=e;return(0,r.jsxs)(t.Z,{offer:n,children:[null===(i=n.experiment)||void 0===i?void 0:i.campaign.shortName," - ",n.shortName]})},s=a;a.__docgenInfo={description:"",methods:[],displayName:"OfferDetailsLink",props:{offer:{required:!0,tsType:{name:"signature",type:"object",raw:"{ __typename: 'Offer', id: string, shortName: string, isControlGroupOffer: boolean, experiment?: { __typename: 'Experiment', id: string, shortName: string, campaign: { __typename: 'Campaign', id: string, shortName: string } } | null }",signature:{properties:[{key:"__typename",value:{name:"literal",value:"'Offer'",required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"shortName",value:{name:"string",required:!0}},{key:"isControlGroupOffer",value:{name:"boolean",required:!0}},{key:"experiment",value:{name:"union",raw:"{ __typename: 'Experiment', id: string, shortName: string, campaign: { __typename: 'Campaign', id: string, shortName: string } } | null",elements:[{name:"signature",type:"object",raw:"{ __typename: 'Experiment', id: string, shortName: string, campaign: { __typename: 'Campaign', id: string, shortName: string } }",signature:{properties:[{key:"__typename",value:{name:"literal",value:"'Experiment'",required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"shortName",value:{name:"string",required:!0}},{key:"campaign",value:{name:"signature",type:"object",raw:"{ __typename: 'Campaign', id: string, shortName: string }",signature:{properties:[{key:"__typename",value:{name:"literal",value:"'Campaign'",required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"shortName",value:{name:"string",required:!0}}]},required:!0}}]}},{name:"null"}],required:!1}}]}},description:""}}}},"./src/shared/components/OfferLink/OfferLink.tsx":function(e,i,n){n.d(i,{Z:()=>g});var r=n("../node_modules/react/jsx-runtime.js"),t=n("../node_modules/@apollo/client/react/hooks/useQuery.js"),a=n("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),s=n("../node_modules/react-router-dom/esm/react-router-dom.js"),d=n("./src/shared/hooks/index.ts"),o=n("./src/shared/utilities/index.ts"),l=n("./src/shared/utilities/IsGranted/index.ts"),m=n("./src/user/hooks/usePermissionState.ts");let u=e=>{var i;let{offer:n,children:t}=e;return t?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsxs)(r.Fragment,{children:[null===(i=n.experiment)||void 0===i?void 0:i.campaign.shortName," - ",n.shortName]})};u.__docgenInfo={description:"Simple component to represent the default innards of a link to an Offer.",methods:[],displayName:"OfferLinkInternal"};var c=n("../node_modules/react-i18next/dist/es/index.js"),p=n("../node_modules/styled-components/dist/styled-components.browser.esm.js");let k=p.ZP.div.withConfig({displayName:"OfferLinkTooltip.styled__TooltipHeader"})(["display:flex;flex-wrap:nowrap;padding-bottom:",";gap:",";align-items:center;"],(0,a.W0)(1),(0,a.W0)(1)),f=p.ZP.div.withConfig({displayName:"OfferLinkTooltip.styled__Skeleton"})(["width:280px;"]),v=e=>{var i,n,t,s,d,o,l;let{loading:m,offer:u,children:p}=e,{t:f}=(0,c.$G)("shared");return(0,r.jsx)(a.u,{colourTheme:"light",tooltip:m||!u?(0,r.jsx)(v.Skeleton,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(k,{children:[(0,r.jsx)("h4",{children:u.shortName}),(null===(i=u.experiment)||void 0===i?void 0:i.campaign.type)&&(0,r.jsx)(a.__,{variant:"flair",children:f(`offer.tooltip.campaign-type.${null===(n=u.experiment)||void 0===n?void 0:n.campaign.type}`)})]}),u.doesSupportReferral&&(u.offerDetails.referrerReward||u.offerDetails.refereeReward)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h5",{children:f("offer.tooltip.rewards","Rewards")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:null==u?void 0:null===(s=u.offerDetails)||void 0===s?void 0:null===(t=s.refereeReward)||void 0===t?void 0:t.shortName}),(0,r.jsx)("p",{children:null==u?void 0:null===(o=u.offerDetails)||void 0===o?void 0:null===(d=o.referrerReward)||void 0===d?void 0:d.shortName})]})]}):null,u.doesSupportIncentiveForAction&&u.incentiveForActionOfferDetails?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h5",{children:f("offer.tooltip.reward","Reward")}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{children:null==u?void 0:null===(l=u.incentiveForActionOfferDetails.incentiveForActionReward)||void 0===l?void 0:l.shortName})})]}):null]}),children:p})};v.Skeleton=()=>(0,r.jsxs)(f,{children:[(0,r.jsx)(k,{children:(0,r.jsx)(a.Od,{})}),(0,r.jsx)(a.Od,{}),(0,r.jsx)(a.Od,{})]}),v.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[],returns:null}],displayName:"OfferLinkTooltip"};let h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchOfferPreviewDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offerId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offer"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offerId"},value:{kind:"Variable",name:{kind:"Name",value:"offerId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"OfferDetailsForLink"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"OfferDetailsForLink"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Offer"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}},{kind:"Field",name:{kind:"Name",value:"isControlGroupOffer"}},{kind:"Field",name:{kind:"Name",value:"doesSupportReferral"}},{kind:"Field",name:{kind:"Name",value:"doesSupportIncentiveForAction"}},{kind:"Field",name:{kind:"Name",value:"experiment"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"campaign"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"offerDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"refereeReward"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}}]}},{kind:"Field",name:{kind:"Name",value:"referrerReward"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"incentiveForActionOfferDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"incentivisedActionRule"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"actionTitle"}},{kind:"Field",name:{kind:"Name",value:"actionSlug"}}]}},{kind:"Field",name:{kind:"Name",value:"incentiveForActionReward"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}}]}}]}}]}}]},N=p.ZP.span.withConfig({displayName:"OfferLink.styled__OfferSpan"})(["text-decoration:underline;text-decoration-style:dotted;"]),_=e=>{let{offer:i,children:n}=e,{merchantId:c}=(0,d.rc)(),{loading:p,data:k}=(0,t.aM)(h,{variables:{offerId:i.id}}),{isLoading:f,data:_}=(0,m.Z)(l.r3.CAMPAIGN),g=!f&&(null==_?void 0:_.granted)||!1;return(0,r.jsx)(a.M2,{shouldWrap:!(null==i?void 0:i.isControlGroupOffer),wrapper:e=>(0,r.jsx)(v,{loading:p,offer:null==k?void 0:k.offer,children:e}),children:g?(0,r.jsx)(a.BY,{as:s.OL,to:(0,o.nu)("fe_offer_preview",{merchantId:c,offerId:i.id}),children:(0,r.jsx)(u,{offer:i,children:n})}):(0,r.jsx)(N,{children:(0,r.jsx)(u,{offer:i,children:n})})})},g=_;_.__docgenInfo={description:"An overly complicated component which renders an OfferLink.\n\nIf the user has permission, we'll render a link to take them to Preview.\nIf they don't have permission, we'll render a styled span.\n\nAnd in all cases we'll wrap it in a tooltip.",methods:[],displayName:"OfferLink"}},"./src/shared/utilities/IsGranted/IsGranted.tsx":function(e,i,n){n.d(i,{Z:()=>o});var r=n("./src/shared/utilities/IsGranted/Permission.tsx"),t=n("../node_modules/react/jsx-runtime.js"),a=n("./src/user/hooks/useActiveUserState.ts"),s=n("./src/shared/utilities/checkHasRole.ts");let d=e=>{let{requiredRole:i,children:n}=e,{isLoading:r,data:d}=(0,a.Z)(),o=Array.isArray(i)?i:[i];return r||!(0,s.Z)(o,(null==d?void 0:d.roles)||[])?null:(0,t.jsx)(t.Fragment,{children:n})};d.__docgenInfo={description:"This component should be used via <IsGranted.Role ...>",methods:[],displayName:"Role"};let o={Role:d,Permission:r.ZP}},"./src/shared/utilities/IsGranted/Permission.tsx":function(e,i,n){n.d(i,{ZP:function(){return d},r3:function(){return a}});var r=n("../node_modules/react/jsx-runtime.js"),t=n("./src/user/hooks/usePermissionState.ts");let a={BETA_USER:"permission.beta_user",CAMPAIGN:"permission.campaign",CLIENT_ACCOUNT_VIEW:"permission.client_account.view",CUSTOMERS:"permission.customers",DASHBOARD:"permission.dashboard",DESIGNS:"permission.designs",INTEGRATION:"permission.integration",MERCHANT_CUSTOMER_EDIT:"permission.merchant.customers.edit",MERCHANT_DEMO_VIEW:"permission.merchant.demo.view",MERCHANT_EDIT:"permission.merchant.edit",MERCHANT_HISTORICAL_CUSTOMERS:"permission.merchant.historical-customers",MERCHANT_SECURE_FILE_TRANSFER:"permission.merchant.secure-file-transfer",PREVIEW:"permission.preview",REPORT:"permission.report",REWARDS:"permission.rewards",SETUP:"permission.setup",USER_2FA_SETUP_AUTHENTICATION:"permission.user.2fa.setup-authentication",USER_2FA_SETUP_RECOVERY:"permission.user.2fa.setup-recovery",USER_2FA_VALIDATE:"permission.user.2fa.validate",USER_EDIT:"permission.user.edit",USER_IMPERSONATE:"permission.user.impersonate",USER_LINK_TO_MERCHANT:"permission.user.link-to-admin",USER_RESET_2FA:"permission.user.reset-2fa"},s=e=>{let{requiredPermission:i,entityType:n,entityId:a,children:s}=e,{isLoading:d,data:o}=(0,t.Z)(i,n,a);return!d&&(null==o?void 0:o.granted)?(0,r.jsx)(r.Fragment,{children:s}):null},d=s;s.__docgenInfo={description:"This component should be used via <IsGranted.Permission ...>",methods:[],displayName:"Permission"}},"./src/shared/utilities/IsGranted/index.ts":function(e,i,n){n.d(i,{ZP:function(){return a},r3:function(){return t.r3}});var r=n("./src/shared/utilities/IsGranted/IsGranted.tsx"),t=n("./src/shared/utilities/IsGranted/Permission.tsx");let a=r.Z},"./src/user/hooks/usePermissionState.ts":function(e,i,n){n.d(i,{Z:()=>a});var r=n("../node_modules/@apollo/client/react/hooks/useQuery.js");let t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"permissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"check"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PermissionInput"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"check"},value:{kind:"Variable",name:{kind:"Name",value:"check"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"granted"}}]}}]}}]},a=(e,i,n)=>{var a;let{data:s,loading:d}=(0,r.aM)(t,{variables:{check:[{permission:e,entityType:i,entityId:String(n)}]},skip:!e});return{isLoading:d,data:null==s?void 0:null===(a=s.permissions)||void 0===a?void 0:a[0]}}}}]);