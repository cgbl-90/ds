"use strict";(globalThis.webpackChunk_mention_me_frontend=globalThis.webpackChunk_mention_me_frontend||[]).push([["1123"],{"./src/client/reporting/hooks/useReportingTimePeriodOptions.ts":function(e,n,a){a.d(n,{K:function(){return l}});var i=a("../node_modules/react/index.js"),t=a("../node_modules/react-i18next/dist/es/index.js");let l=e=>{let{options:n,variant:a}=e,{t:l}=(0,t.$G)("reporting");return(0,i.useMemo)(()=>n.map(e=>{let{value:n,isDisabled:i,tooltip:t}=e;return{label:l(`reporting:periods.${n.toLowerCase()}${"short"===a?"-short":""}`),value:n,isDisabled:i,tooltip:t}}),[l,n,a])}},"./src/client/reporting/incremental-value/IncrementalValue.types.ts":function(e,n,a){var i,t,l,r;a.d(n,{P:function(){return t},r:function(){return i}}),(l=i||(i={})).REPEAT_REVENUE="INCREASE_REPEAT_REVENUE",l.MARKETING_DATABASE="INCREASE_MARKETING_DATABASE",(r=t||(t={}))[r.THIRTY_DAYS=30]="THIRTY_DAYS",r[r.SIXTY_DAYS=60]="SIXTY_DAYS",r[r.NINETY_DAYS=90]="NINETY_DAYS",r[r.ONE_HUNDRED_AND_EIGHTY_DAYS=180]="ONE_HUNDRED_AND_EIGHTY_DAYS"},"./src/client/reporting/incremental-value/context/IncrementalValuePageContext.ts":function(e,n,a){a.d(n,{t:function(){return t},u:function(){return i}});let[i,t]=(0,a("../node_modules/@mention-me/flamingo-ui/build/index.es.js").kr)({hookName:"useIncrementalValueContext",providerName:"IncrementalValueStateProvider"})},"./src/client/reporting/incremental-value/context/IncrementalValuePageProvider.tsx":function(e,n,a){a.d(n,{p:()=>b,R:()=>I});var i=a("../node_modules/react/jsx-runtime.js"),t=a("../node_modules/react/index.js"),l=a("../node_modules/@apollo/client/react/hooks/useQuery.js"),r=a("../node_modules/react-router/esm/react-router.js"),d=a("./src/shared/@types/graphql.ts"),u=a("./src/shared/@types/reporting.ts"),o=a("./src/shared/hooks/index.ts"),s=a("./src/shared/hooks/useFeatureAccess/useFeatureAccess.tsx"),m=a("./src/shared/hooks/useIsDemo.ts"),c=a("./src/shared/hooks/useProductUpsellRequest/index.ts"),v=a("./src/shared/utilities/index.ts"),k=a("./src/client/reporting/hooks/ReportingContext.tsx"),N=a("./src/client/reporting/hooks/useUpdateQueryString.ts");let p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchIncrementalValueSuitability"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"merchantId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"merchant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"merchantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"propensityToReferSuitability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"overallStatus"}},{kind:"Field",name:{kind:"Name",value:"estimatedOrderAvailibilty"}},{kind:"Field",name:{kind:"Name",value:"orderCount"}},{kind:"Field",name:{kind:"Name",value:"hasMerchantEnoughOrders"}}]}}]}}]}}]};var E=a("./src/client/reporting/incremental-value/hooks/useIncrementalValueCampaigns.ts"),A=a("./src/client/reporting/incremental-value/hooks/useIncrementalValueControls.ts"),S=a("./src/client/reporting/incremental-value/IncrementalValue.types.ts"),_=a("./src/client/reporting/incremental-value/context/IncrementalValuePageContext.ts");let T={30:S.P.THIRTY_DAYS,60:S.P.SIXTY_DAYS,90:S.P.NINETY_DAYS,180:S.P.ONE_HUNDRED_AND_EIGHTY_DAYS},g=e=>{if(!!e)return T[e]},R={[S.r.REPEAT_REVENUE]:"repeat-revenue",[S.r.MARKETING_DATABASE]:"marketing-database"},I=e=>R[e],D={"repeat-revenue":S.r.REPEAT_REVENUE,"marketing-database":S.r.MARKETING_DATABASE},h=e=>e&&D[e]||S.r.REPEAT_REVENUE,b=e=>{var n,a;let{children:T}=e,R=(0,r.k6)(),D=(0,r.TH)(),{isDemo:b}=(0,m.Z)(),{merchantId:y}=(0,o.rc)(),f=(0,N.Z)(),V=(0,c.Z)(),{setTimePeriod:Y}=(0,k.IF)(),{timePeriod:P}=(0,k.eh)(),x=g(new URLSearchParams(D.search).get("repeatWindow"))||S.P.THIRTY_DAYS,[F,M]=(0,t.useState)(x),{params:{selectedGoal:C}}=(0,r.$B)(),[O,H]=(0,t.useState)(h(C)),{accessState:U,loading:j}=(0,s.Z)(d.dn.SmartExperimentDriveAction),L=(0,E.Z)(O,F),{data:G,loading:w}=(0,l.aM)(p,{variables:{merchantId:y}}),q=!!(null==L?void 0:null===(n=L.data)||void 0===n?void 0:n.length)&&(null==L?void 0:null===(a=L.data)||void 0===a?void 0:a.every(e=>!b&&!e.hasWinner)),B=(0,t.useCallback)(()=>{V.sendProductUpsellRequest("Incremental Value")},[V]),Z=(0,t.useCallback)(function(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];H(e),n&&R.replace({pathname:(0,v.nu)("fe_incremental_value",{merchantId:y,selectedGoal:I(e)}),search:D.search}),e===S.r.REPEAT_REVENUE&&!(0,A.Yg)(P,e)&&Y(u.Iq.LAST_ALL_TIME)},[R,D.search,y,Y,P]),K=(0,t.useCallback)(e=>{M(e),f("repeatWindow",e,S.P.THIRTY_DAYS)},[f]);(0,t.useEffect)(()=>{O===S.r.REPEAT_REVENUE&&!(0,A._S)(P,F)&&K(S.P.THIRTY_DAYS)},[O,F,P,K]);let W=(0,t.useMemo)(()=>({selectedGoal:O,selectedRepeatWindow:F,hasFeatureAccess:U===d.PS.HasAccess&&!j,isLoadingFeatureAccess:j,isAwaitingData:q,campaignsData:L,suitabilityData:G,isSuitabilityLoading:w,upsellRequest:V,updateGoal:Z,updateRepeatWindow:K,requestUpsell:B}),[O,F,j,U,L,G,q,w,V,Z,K,B]);return(0,i.jsx)(_.u,{value:W,children:T})};b.__docgenInfo={description:"",methods:[],displayName:"IncrementalValuePageProvider"}},"./src/client/reporting/incremental-value/hooks/useIncrementalValueCampaigns.ts":function(e,n,a){a.d(n,{Z:()=>m});var i=a("../node_modules/react/index.js"),t=a("../node_modules/@apollo/client/react/hooks/useQuery.js"),l=a("./src/client/reporting/hooks/ReportingContext.tsx"),r=a("./src/shared/constants/filterStatuses.ts"),d=a("./src/shared/hooks/index.ts"),u=a("./src/shared/hooks/useIsDemo.ts");let o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchIncrementalValueCampaigns"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"merchantId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timePeriod"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"repeatWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"goal"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mixed"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"statuses"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Mixed"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"merchant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"merchantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"reportingCurrencySymbol"}},{kind:"Field",name:{kind:"Name",value:"campaigns"},arguments:[{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"field"},value:{kind:"StringValue",value:"PublishedOnDate",block:!1}},{kind:"ObjectField",name:{kind:"Name",value:"direction"},value:{kind:"EnumValue",value:"DESC"}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}},{kind:"Field",name:{kind:"Name",value:"hasAnyChildExperimentConcluded"}},{kind:"Field",name:{kind:"Name",value:"incrementalValueMetrics"},arguments:[{kind:"Argument",name:{kind:"Name",value:"timePeriod"},value:{kind:"Variable",name:{kind:"Name",value:"timePeriod"}}},{kind:"Argument",name:{kind:"Name",value:"repeatWindow"},value:{kind:"Variable",name:{kind:"Name",value:"repeatWindow"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"metricId"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}},{kind:"Field",name:{kind:"Name",value:"experiments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filterBy"},value:{kind:"ListValue",values:[{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"field"},value:{kind:"StringValue",value:"PropensityToReferType",block:!1}},{kind:"ObjectField",name:{kind:"Name",value:"operator"},value:{kind:"EnumValue",value:"EQUALS"}},{kind:"ObjectField",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"goal"}}}]},{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"field"},value:{kind:"StringValue",value:"Status",block:!1}},{kind:"ObjectField",name:{kind:"Name",value:"operator"},value:{kind:"EnumValue",value:"IN"}},{kind:"ObjectField",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"statuses"}}}]}]}},{kind:"Argument",name:{kind:"Name",value:"orderBy"},value:{kind:"ListValue",values:[{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"field"},value:{kind:"StringValue",value:"ExecutionStartDate",block:!1}},{kind:"ObjectField",name:{kind:"Name",value:"direction"},value:{kind:"EnumValue",value:"DESC"}}]}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortName"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"hasConcluded"}}]}}]}}]}}]}}]}}]}}]};var s=a("./src/client/reporting/incremental-value/IncrementalValue.types.ts");let m=(e,n)=>{var a,m,c;let{merchantId:v}=(0,d.rc)(),{isDemo:k}=(0,u.Z)(),{timePeriod:N}=(0,l.eh)(),{data:p,loading:E}=(0,t.aM)(o,{variables:{merchantId:v,timePeriod:N,repeatWindow:e===s.r.REPEAT_REVENUE?n:void 0,goal:e,statuses:[r.Z.RUNNING,r.Z.HAS_RUN,...k?[r.Z.DRAFT]:[]]}}),A=(0,i.useMemo)(()=>{var n,a;return((null==p?void 0:null===(a=p.merchant)||void 0===a?void 0:null===(n=a.campaigns)||void 0===n?void 0:n.edges)||[]).filter(e=>{var n,a;return((null==e?void 0:null===(a=e.experiments)||void 0===a?void 0:null===(n=a.edges)||void 0===n?void 0:n.length)||0)>0}).map(n=>{var a,i,t,l,d,u,o,m,c,v,N;let p=(null==n?void 0:n.incrementalValueMetrics)||[],E={...e===s.r.REPEAT_REVENUE?{incrementalRevenue:null===(a=p.find(e=>{let{metricId:n}=e;return"MetricPropensityToReferIncrementalRevenueRepeatRateGoal"===n}))||void 0===a?void 0:a.value,repeatRevenue:null===(i=p.find(e=>{let{metricId:n}=e;return"MetricPropensityToReferAdditionalRevenueFromRepeatRepeatRateGoal"===n}))||void 0===i?void 0:i.value,referralRevenueMissed:null===(t=p.find(e=>{let{metricId:n}=e;return"MetricPropensityToReferMissedReferralRevenueRepeatRateGoal"===n}))||void 0===t?void 0:t.value}:{newSignUps:null===(l=p.find(e=>{let{metricId:n}=e;return"MetricPropensityToReferCountOfDriveAction"===n}))||void 0===l?void 0:l.value,referralRevenueMissed:null===(d=p.find(e=>{let{metricId:n}=e;return"MetricPropensityToReferMissedReferralRevenueMarketingDatabaseGoal"===n}))||void 0===d?void 0:d.value}},A=((null==n?void 0:null===(u=n.experiments)||void 0===u?void 0:u.edges)||[]).filter(e=>{let{status:n}=e;return n===r.Z.RUNNING}),S=((null==n?void 0:null===(o=n.experiments)||void 0===o?void 0:o.edges)||[]).filter(e=>{let{status:n}=e;return n===r.Z.HAS_RUN});return{id:n.id,shortName:n.shortName,experiments:null==n?void 0:null===(m=n.experiments)||void 0===m?void 0:m.edges,latestExperimentId:null==n?void 0:null===(N=n.experiments)||void 0===N?void 0:null===(v=N.edges)||void 0===v?void 0:null===(c=v[0])||void 0===c?void 0:c.id,runningExperimentsCount:k?1:A.length,previousExperimentsCount:S.length,hasWinner:k||e===s.r.MARKETING_DATABASE||!!(null==n?void 0:n.hasAnyChildExperimentConcluded),...E}})},[null==p?void 0:null===(m=p.merchant)||void 0===m?void 0:null===(a=m.campaigns)||void 0===a?void 0:a.edges,e,k]);return{merchantCurrencySymbol:null==p?void 0:null===(c=p.merchant)||void 0===c?void 0:c.reportingCurrencySymbol,data:A,loading:E}}},"./src/client/reporting/incremental-value/hooks/useIncrementalValueControls.ts":function(e,n,a){a.d(n,{Yg:function(){return s},_S:function(){return m},c$:function(){return c}});var i=a("../node_modules/react/index.js"),t=a("../node_modules/react-i18next/dist/es/index.js"),l=a("./src/client/reporting/hooks/useReportingTimePeriodOptions.ts"),r=a("./src/shared/@types/reporting.ts"),d=a("./src/client/reporting/hooks/ReportingContext.tsx"),u=a("./src/client/reporting/incremental-value/context/IncrementalValuePageContext.ts"),o=a("./src/client/reporting/incremental-value/IncrementalValue.types.ts");let s=(e,n)=>{switch(n){case o.r.REPEAT_REVENUE:return[r.Iq.LAST_60_DAYS,r.Iq.LAST_12_MONTHS,r.Iq.LAST_ALL_TIME].includes(e);case o.r.MARKETING_DATABASE:return!0;default:return!1}},m=(e,n)=>{switch(e){case r.Iq.LAST_60_DAYS:return[o.P.THIRTY_DAYS].includes(n);case r.Iq.LAST_12_MONTHS:case r.Iq.LAST_ALL_TIME:return[o.P.THIRTY_DAYS,o.P.SIXTY_DAYS,o.P.NINETY_DAYS,o.P.ONE_HUNDRED_AND_EIGHTY_DAYS].includes(n);default:return!1}},c=()=>{let{t:e}=(0,t.$G)("reporting"),{timePeriod:n}=(0,d.eh)(),{selectedGoal:a}=(0,u.t)(),s=(0,i.useMemo)(()=>[...a===o.r.MARKETING_DATABASE?[{value:r.Iq.LAST_7_DAYS},{value:r.Iq.LAST_30_DAYS}]:[],{value:r.Iq.LAST_60_DAYS},{value:r.Iq.LAST_12_MONTHS},{value:r.Iq.LAST_ALL_TIME}],[a]),c=(0,l.K)({options:s}),v=(0,i.useMemo)(()=>[{key:e("incremental-value.repeat-window.30-day","30 day"),value:o.P.THIRTY_DAYS,disabled:!m(n,o.P.THIRTY_DAYS)},{key:e("incremental-value.repeat-window.60-day","60 day"),value:o.P.SIXTY_DAYS,disabled:!m(n,o.P.SIXTY_DAYS)},{key:e("incremental-value.repeat-window.90-day","90 day"),value:o.P.NINETY_DAYS,disabled:!m(n,o.P.NINETY_DAYS)},{key:e("incremental-value.repeat-window.180-day","180 day"),value:o.P.ONE_HUNDRED_AND_EIGHTY_DAYS,disabled:!m(n,o.P.ONE_HUNDRED_AND_EIGHTY_DAYS)}],[e,n]);return{goals:(0,i.useMemo)(()=>[{label:e("incremental-value.goals.INCREASE_REPEAT_REVENUE","Repeat Revenue"),value:o.r.REPEAT_REVENUE},{label:e("incremental-value.goals.INCREASE_MARKETING_DATABASE","Marketing Database"),value:o.r.MARKETING_DATABASE}],[e]),timePeriods:c,repeatWindows:v}}}}]);