"use strict";(globalThis.webpackChunk_mention_me_frontend=globalThis.webpackChunk_mention_me_frontend||[]).push([["9814"],{"./src/client/reporting/incremental-value/components/IncrementalValueControls/IncrementalValueControls.tsx":function(e,n,t){t.d(n,{Q:()=>x,M:()=>k});var i=t("../node_modules/react/jsx-runtime.js"),a=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),r=t("../node_modules/react-i18next/dist/es/index.js"),l=t("./src/client/reporting/hooks/ReportingContext.tsx"),o=t("./src/client/reporting/incremental-value/context/IncrementalValuePageContext.ts"),s=t("./src/client/reporting/incremental-value/hooks/useIncrementalValueControls.ts"),d=t("./src/client/reporting/incremental-value/IncrementalValue.types.ts"),c=t("../node_modules/styled-components/dist/styled-components.browser.esm.js"),m=t("./src/shared/components/index.ts");let u=(0,c.ZP)(a.Zb).withConfig({displayName:"IncrementalValueControls.styled__Card"})(["border-color:",";background-color:",";"],(0,a.Ys)("Cornflower60"),(0,a.Ys)("Cornflower20")),p=c.ZP.div.withConfig({displayName:"IncrementalValueControls.styled__Field"})(["display:flex;flex-wrap:wrap;align-items:center;gap:",";"],(0,a.W0)(1)),h=(0,c.ZP)(a.M).withConfig({displayName:"IncrementalValueControls.styled__Label"})(["display:flex;align-items:center;gap:",";"],(0,a.W0)(.5)),g=c.ZP.fieldset.withConfig({displayName:"IncrementalValueControls.styled__Fieldset"})(["display:flex;flex-wrap:wrap;gap:",";border:0;padding:0.01em 0 0;margin:0;min-width:0;"],(0,a.W0)(2)),y=(0,c.ZP)(m.WW).withConfig({displayName:"IncrementalValueControls.styled__Help"})(["line-height:0;"]),v=(0,c.ZP)(m.lq).withConfig({displayName:"IncrementalValueControls.styled__SelectInput"})(["background:",";&:hover:not(:disabled),&:focus:not(:disabled){background:",";}"],(0,a.Ys)("White"),(0,a.Ys)("White")),f="incremental-value-business-goal-toggle-label",k=e=>{let{shouldUpdatePath:n=!0}=e,{t}=(0,r.$G)("reporting",{keyPrefix:"incremental-value"}),{selectedGoal:c,selectedRepeatWindow:m,updateGoal:u,updateRepeatWindow:k}=(0,o.t)(),{timePeriod:x}=(0,l.eh)(),{setTimePeriod:b}=(0,l.IF)(),{goals:C,timePeriods:w,repeatWindows:N}=(0,s.c$)();return(0,i.jsxs)(g,{children:[(0,i.jsxs)(p,{children:[(0,i.jsx)(a.M,{as:"label",id:f,children:t("controls.labels.business-goal","View value by business goal:")}),(0,i.jsx)(a.sY,{options:C,size:"default",radioGroupAttrs:{"aria-labelledby":f},state:{name:"incremental-value-business-goal-toggle",value:c,onChange:e=>{u(e,n)}}})]}),(0,i.jsxs)(p,{children:[(0,i.jsx)(a.M,{children:t("controls.labels.time-period","from the:")}),(0,i.jsx)(v,{variant:"secondary",value:x,onChange:e=>b(e),options:w.map(e=>({key:e.label,value:e.value}))})]}),c===d.r.REPEAT_REVENUE&&(0,i.jsxs)(p,{children:[(0,i.jsx)(h,{children:t("controls.labels.repeat-window_pre","based on a:")}),(0,i.jsx)(v,{variant:"secondary",options:N,value:m,onChange:e=>k(e)}),(0,i.jsxs)(h,{as:"label",children:[t("controls.labels.repeat-window_post","repeat window"),(0,i.jsx)(y,{message:t("tooltips.repeat-window-dropdown","We calculate the incremental value generated by calculating Repeat revenue within the selected time period, starting from the individuals first purchase to their second.")})]})]})]})},x=e=>{let{shouldUpdatePath:n}=e;return(0,i.jsx)(u,{forwardedAs:"form",variant:"border",children:(0,i.jsx)(k,{shouldUpdatePath:n})})};k.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueControlsContent",props:{shouldUpdatePath:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}},x.__docgenInfo={description:"",methods:[],displayName:"IncrementalValueControls",props:{shouldUpdatePath:{required:!1,tsType:{name:"boolean"},description:""}}}},"./src/client/reporting/incremental-value/components/IncrementalValueOverTimeChart/IncrementalValueOverTimeChart.tsx":function(e,n,t){t.d(n,{Z:()=>I});var i,a,r=t("../node_modules/react/jsx-runtime.js"),l=t("../node_modules/react/index.js"),o=t("../node_modules/@heroicons/react/24/solid/esm/QuestionMarkCircleIcon.js"),s=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),d=t("../node_modules/react-i18next/dist/es/index.js"),c=t("./src/client/reporting/hooks/ReportingContext.tsx"),m=t("./src/shared/@types/graphql.ts"),u=t("./src/shared/@types/reporting.ts"),p=t("./src/shared/components/Charts/LineChart/index.ts"),h=t("./src/shared/components/Charts/LineChart/hooks/useLineChartConfig/useLineChartConfig.tsx"),g=t("./src/shared/hooks/index.ts"),y=t("./src/shared/utilities/index.ts"),v=t("./src/client/reporting/incremental-value/context/IncrementalValuePageContext.ts"),f=t("./src/client/reporting/incremental-value/IncrementalValue.types.ts"),k=t("./src/client/reporting/utilities/inferGroupByFromTimePeriod.ts"),x=t("./src/shared/hooks/useMetricValuesOverTime/useMetricValuesOverTime.ts");let b=[m.i3.PropensityToReferAdditionalRevenueFromRepeat,m.i3.PropensityToReferIncrementalRevenue,m.i3.PropensityToReferMissedReferralRevenue],C=function(){let{campaignId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{t:n}=(0,d.$G)("reporting",{keyPrefix:"incremental-value.over-time-chart"}),{selectedGoal:t,selectedRepeatWindow:i}=(0,v.t)(),{timePeriod:a}=(0,c.eh)(),r=t===f.r.REPEAT_REVENUE?b:[m.i3.PropensityToReferActionsTaken],{isLoading:o,series:s}=(0,x.Z)(r,{campaignId:e,timePeriod:a,groupBy:(0,k.Z)(a),repeatWindow:t===f.r.REPEAT_REVENUE?i:void 0}),u=(0,l.useMemo)(()=>(s||[]).map(e=>({...e,name:n("serie-name",{context:e.metric})})),[s,n]);return{data:s,loading:o,series:u}};var w=t("../node_modules/styled-components/dist/styled-components.browser.esm.js");let N=w.ZP.div.withConfig({displayName:"IncrementalValueOverTimeChart.styled__Header"})(["display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;"]),_=w.ZP.div.withConfig({displayName:"IncrementalValueOverTimeChart.styled__Body"})(["margin-top:",";"],(0,s.W0)(2)),P=()=>{let{t:e}=(0,d.$G)("reporting",{keyPrefix:"incremental-value.over-time-chart"}),{selectedGoal:n}=(0,v.t)();return(0,r.jsx)(s.H4,{children:e("heading","Marketing contacts captured over time",{context:n})})},j=()=>{let{t:e}=(0,d.$G)("reporting",{keyPrefix:"incremental-value.over-time-chart"}),{selectedRepeatWindow:n}=(0,v.t)(),t=e("repeat-tooltip.copy","Repeat revenue is calculated over a {{ repeatWindow }} day repeat window, starting at the date of initial purchase. Because of this, we can't show the value generated for the last {{ repeatWindow }} days.",{repeatWindow:n});return(0,r.jsx)(s.u,{tooltip:t,children:(0,r.jsxs)(s.eg,{variant:"light",size:"sm",children:[(0,r.jsx)(s.eg.Icon,{children:(0,r.jsx)(o.Z,{})}),(0,r.jsx)(s.eg.Body,{children:(0,r.jsx)(s.S,{children:e("repeat-tooltip.label","Where's the data from the last {{ repeatWindow }} days?",{repeatWindow:n})})})]})})};(i=a||(a={})).OVERALL_ACCUMULATION="overall-accumulation",i.MONTHLY_CALCULATION="monthly-calculation";let V={[m.i3.PropensityToReferIncrementalRevenue]:!1,[m.i3.PropensityToReferAdditionalRevenueFromRepeat]:["SkyBlueBase","SkyBlue40Light"],[m.i3.PropensityToReferMissedReferralRevenue]:["MidnightBlueBase","MidnightBlue40Light"],[m.i3.PropensityToReferActionsTaken]:["UltraVioletBase","UltraViolet40Light"]},I=e=>{let{campaignId:n,shouldIncludeHeader:t=!0,isLoading:i}=e,{merchantId:a}=(0,g.rc)(),{t:o}=(0,d.$G)("reporting",{keyPrefix:"incremental-value.over-time-chart"}),{timePeriod:k}=(0,c.eh)(),{selectedGoal:x}=(0,v.t)(),b=(0,l.useMemo)(()=>x===f.r.REPEAT_REVENUE,[x]),{data:w,loading:T,series:R}=C({campaignId:n}),{data:S,loading:M}=(0,g.EO)(a),[L,W]=(0,l.useState)("overall-accumulation"),A=[{value:"overall-accumulation",label:o("chart-type-toggle.overall-accumulation","Overall accumulation")},{value:"monthly-calculation",label:o("chart-type-toggle.monthly-calculation","Monthly calculation")}],F=(0,l.useMemo)(()=>b?R.length?"overall-accumulation"===L?[R.find(e=>e.metric===m.i3.PropensityToReferIncrementalRevenue)]:[R.find(e=>e.metric===m.i3.PropensityToReferAdditionalRevenueFromRepeat),R.find(e=>e.metric===m.i3.PropensityToReferMissedReferralRevenue)]:[]:R,[b,R,L]),D=(0,l.useMemo)(()=>b?"overall-accumulation"===L?["UltraVioletBase"]:["SkyBlue80Dark","MidnightBlueBase"]:["UltraVioletBase"],[L,b]),Z=(0,l.useMemo)(()=>R.reduce((e,n)=>(e[n.id]=V[n.metric],e),{}),[R]),E=(0,h.cf)(F);return T&&!(null==w?void 0:w.length)||M||i?(0,r.jsx)(I.Skeleton,{shouldIncludeHeader:t}):(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsxs)(N,{children:[(0,r.jsx)(P,{}),b&&(0,r.jsx)(s.sY,{options:A,size:"default",state:{name:`incremental-value-repeat-revenue-chart-type${n?`-${n}`:""}`,value:L,onChange:e=>{W(e)}}}),b&&(0,r.jsx)(j,{})]}),(0,r.jsx)(_,{children:(0,r.jsx)(p.Z,{variant:"compact",series:F,shouldAlwaysShowLegend:!0,wrapperStyles:{height:350},isAreaChart:!0,colors:D,curve:"monotoneX",yMinValue:b?E:0,pointSize:7,margin:{left:80},xScale:{type:"time",format:"%Y-%m-%d",useUTC:!1,precision:"day"},xFormat:k===u.Iq.LAST_60_DAYS?"time:%e %b %Y":"time:%b %y",gridYValues:10,axisLeft:{legend:o("axis-left-legend","Number of Opt-ins",{context:x}),legendPosition:"middle",legendOffset:-70,tickValues:5,format:e=>(0,y.qp)(e,{type:b?m.mV.Currency:m.mV.Number,currencySymbol:null==S?void 0:S.reportingCurrencySymbol})},axisBottom:{format:k===u.Iq.LAST_60_DAYS?"%e %b %Y":"%b %y",tickValues:k===u.Iq.LAST_60_DAYS?"every 2 mondays":"every 2 months",tickSize:10,tickPadding:5,ticksPosition:"after"},areaGradientConfig:Z})})]})};I.Skeleton=e=>{let{shouldIncludeHeader:n=!0}=e;return(0,r.jsxs)(r.Fragment,{children:[n&&(0,r.jsx)(N,{children:(0,r.jsx)(P,{})}),(0,r.jsx)(_,{children:(0,r.jsx)(p.Z.Skeleton,{wrapperStyles:{height:250}})})]})},I.__docgenInfo={description:"",methods:[{name:"Skeleton",docblock:null,modifiers:["static"],params:[{name:'{ shouldIncludeHeader = true }: Pick<Props, "shouldIncludeHeader">',optional:!1,type:{name:"Pick",elements:[{name:"Props"},{name:"literal",value:'"shouldIncludeHeader"'}],raw:'Pick<Props, "shouldIncludeHeader">',alias:"Pick"}}],returns:null}],displayName:"IncrementalValueOverTimeChart",props:{campaignId:{required:!1,tsType:{name:"string"},description:""},shouldIncludeHeader:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},isLoading:{required:!1,tsType:{name:"boolean"},description:""}}}},"./src/client/reporting/incremental-value/graphql/fetchIncrementalValueHeadlineMetrics.generated.ts":function(e,n,t){t.d(n,{L:function(){return i}});let i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"fetchIncrementalValueHeadlineMetrics"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"merchantId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timePeriod"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"repeatWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"merchant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"merchantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"reportingCurrencySymbol"}},{kind:"Field",name:{kind:"Name",value:"propensityToReferStats"},arguments:[{kind:"Argument",name:{kind:"Name",value:"timePeriod"},value:{kind:"Variable",name:{kind:"Name",value:"timePeriod"}}},{kind:"Argument",name:{kind:"Name",value:"repeatWindow"},value:{kind:"Variable",name:{kind:"Name",value:"repeatWindow"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"repeatRevenueHeadlineMetrics"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}},{kind:"Field",name:{kind:"Name",value:"primaryMetric"}},{kind:"Field",name:{kind:"Name",value:"secondaryMetric"}},{kind:"Field",name:{kind:"Name",value:"referralRevenueMissed"}}]}},{kind:"Field",name:{kind:"Name",value:"marketingDatabaseHeadlineMetrics"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"startDate"}},{kind:"Field",name:{kind:"Name",value:"endDate"}},{kind:"Field",name:{kind:"Name",value:"primaryMetric"}},{kind:"Field",name:{kind:"Name",value:"secondaryMetric"}},{kind:"Field",name:{kind:"Name",value:"referralRevenueMissed"}}]}}]}}]}}]}}]}},"./src/shared/components/DashboardLayout/DashboardLayout.styled.tsx":function(e,n,t){t.d(n,{$0:function(){return o},Jd:function(){return c},NB:function(){return l},X6:function(){return d},gM:function(){return s},rj:function(){return r}});var i=t("../node_modules/@mention-me/flamingo-ui/build/index.es.js"),a=t("../node_modules/styled-components/dist/styled-components.browser.esm.js");let r=(0,a.ZP)("div").withConfig((0,i.NZ)("gridConfig")).withConfig({displayName:"DashboardLayout.styled__Grid"})(["display:grid;grid-gap:32px 16px;",""],e=>e.gridConfig.map(e=>(0,a.iv)(["@media (min-width:","px){grid-template-columns:repeat(",",1fr);}"],e.minWidth,e.columns))),l=(0,a.ZP)("div").withConfig((0,i.NZ)("componentConfig","index")).withConfig({displayName:"DashboardLayout.styled__ComponentWrapper"})([""," "," &:empty{display:none;}"],e=>e.componentConfig.map(e=>(0,a.iv)(["@media (min-width:","px){grid-column-end:span ",";}"],e.minWidth,e.columns)),e=>{let{index:n}=e;return 0===n&&(0,a.iv)(["grid-column-start:1;"])}),o=a.ZP.section.withConfig({displayName:"DashboardLayout.styled__Section"})(["display:flex;flex-direction:column;height:100%;"]),s=a.ZP.div.withConfig({displayName:"DashboardLayout.styled__HeaderContainer"})(["display:flex;flex-wrap:wrap;gap:",";align-items:center;justify-content:space-between;margin-bottom:1rem;"],(0,i.W0)(1)),d=(0,a.ZP)(i.H4).withConfig({displayName:"DashboardLayout.styled__Heading"})(["display:flex;gap:",";align-items:center;"],(0,i.W0)(1));(0,i.W0)(2),(0,i.W0)([6,3]);let c=a.ZP.div.withConfig((0,i.NZ)("variant")).withConfig({displayName:"DashboardLayout.styled__NoData"})(["border-radius:",";background-color:",";display:flex;flex-direction:column;gap:",";align-items:center;justify-content:center;text-align:center;padding:",";"],(0,i.W0)(.5),e=>{let{variant:n="grey"}=e;return"grey"===n?(0,i.Ys)("GreyBase",50):"none"},(0,i.W0)(2),(0,i.W0)([4,2]))}}]);